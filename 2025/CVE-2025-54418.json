{
	"id": "CVE-2025-54418",
	"sourceIdentifier": "security-advisories@github.com",
	"vulnStatus": "Analyzed",
	"published": "2025-07-28T15:15:26.957",
	"lastModified": "2025-08-05T15:46:02.750",
	"descriptions": [
		{
			"lang": "en",
			"value": "CodeIgniter is a PHP full-stack web framework. A command injection vulnerability present in versions prior to 4.6.2 affects applications that use the ImageMagick handler for image processing (`imagick` as the image library) and either allow file uploads with user-controlled filenames and process uploaded images using the `resize()` method or use the `text()` method with user-controlled text content or options. An attacker can upload a file with a malicious filename containing shell metacharacters that get executed when the image is processed or provide malicious text content or options that get executed when adding text to images Users should upgrade to v4.6.2 or later to receive a patch. As a workaround, switch to the GD image handler (`gd`, the default handler), which is not affected by either vulnerability. For file upload scenarios, instead of using user-provided filenames, generate random names to eliminate the attack vector with `getRandomName()` when using the `move()` method, or use the `store()` method, which automatically generates safe filenames. For text operations, if one must use ImageMagick with user-controlled text, sanitize the input to only allow safe characters and validate/restrict text options."
		},
		{
			"lang": "es",
			"value": "CodeIgniter es un framework web PHP full-stack. Una vulnerabilidad de inyección de comandos presente en versiones anteriores a la 4.6.2 afecta a las aplicaciones que usan el manejador ImageMagick para el procesamiento de imágenes (`imagick` como librería de imágenes) y que permiten la carga de archivos con nombres controlados por el usuario y procesan las imágenes cargadas usando el método `resize()` o usan el método `text()` con contenido de texto u opciones controlados por el usuario. Un atacante puede cargar un archivo con un nombre malicioso que contenga metacaracteres de shell que se ejecuten cuando se procese la imagen o proporcionar contenido de texto malicioso u opciones que se ejecuten al agregar texto a las imágenes. Los usuarios deben actualizar a la v4.6.2 o posterior para recibir un parche. Como solución alternativa, cambie al manejador de imágenes GD (`gd`, el manejador predeterminado), que no se ve afectado por ninguna de las vulnerabilidades. Para la carga de archivos, en lugar de usar nombres de archivo proporcionados por el usuario, genere nombres aleatorios para eliminar el vector de ataque con `getRandomName()` al usar el método `move()`, o use el método `store()`, que genera automáticamente nombres de archivo seguros. Para operaciones de texto, si es necesario usar ImageMagick con texto controlado por el usuario, depure la entrada para permitir solo caracteres seguros y valide/restringa las opciones de texto."
		}
	],
	"references": [
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Not Applicable"
			],
			"url": "https://cwe.mitre.org/data/definitions/78.html"
		},
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Patch"
			],
			"url": "https://github.com/codeigniter4/CodeIgniter4/commit/e18120bff1da691e1d15ffc1bf553ae7411762c0"
		},
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Vendor Advisory",
				"Mitigation"
			],
			"url": "https://github.com/codeigniter4/CodeIgniter4/security/advisories/GHSA-9952-gv64-x94c"
		},
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Not Applicable"
			],
			"url": "https://owasp.org/www-community/attacks/Command_Injection"
		}
	],
	"metrics": {
		"cvssMetricV31": [
			{
				"source": "security-advisories@github.com",
				"type": "Secondary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
					"attackVector": "NETWORK",
					"attackComplexity": "LOW",
					"privilegesRequired": "NONE",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "HIGH",
					"integrityImpact": "HIGH",
					"availabilityImpact": "HIGH",
					"baseScore": 9.8,
					"baseSeverity": "CRITICAL"
				},
				"exploitabilityScore": 3.9,
				"impactScore": 5.9
			}
		]
	},
	"weaknesses": [
		{
			"source": "security-advisories@github.com",
			"type": "Primary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-78"
				}
			]
		}
	],
	"configurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:codeigniter:codeigniter:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "0646754C-2BA8-40F6-8838-5491EF4FDAA4",
							"versionStartIncluding": "4.0.0",
							"versionEndExcluding": "4.6.2"
						}
					]
				}
			]
		}
	],
	"vcConfigurations": [
		{
			"nodes": [
				{
					"operator": "",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:codeigniter:codeigniter:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "",
							"versionEndExcluding": "4.6.2"
						}
					]
				}
			]
		}
	],
	"vcVulnerableCPEs": [
		"cpe:2.3:a:codeigniter:codeigniter:1.0:beta:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:1.1:beta:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:1.2.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:1.3.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:1.3.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:1.3.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:1.3.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:1.4.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:1.4.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:1.4.9:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:1.5.0.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:1.5.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:1.5.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:1.5.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:1.5.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:1.5.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:1.6.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:1.6.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:1.6.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:1.6.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:1.7.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:1.7.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:1.7.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:2.0.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:2.0.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:2.0.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:2.0.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:2.1.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:2.1.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:2.1.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:2.1.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:2.1.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:2.2.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:2.2.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:2.2.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:2.2.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:2.2.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:2.2.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:2.2.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:3.0.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:3.0.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:3.0.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:3.0.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:3.0.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:3.0.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:3.0.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:3.0:-:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:3.0:rc2:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:3.0:rc3:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:3.0:rc:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:3.1.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:3.1.10:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:3.1.11:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:3.1.13:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:3.1.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:3.1.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:3.1.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:3.1.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:3.1.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:3.1.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:3.1.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:3.1.8:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:3.1.9:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.0.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.0.0:-:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.0.0:alpha1:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.0.0:alpha2:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.0.0:alpha3:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.0.0:alpha4:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.0.0:alpha5:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.0.0:beta1:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.0.0:beta3:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.0.0:beta4:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.0.0:rc1:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.0.0:rc2.1:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.0.0:rc2:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.0.0:rc3:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.0.0:rc4:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.0.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.0.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.0.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.0.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.0.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.1.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.1.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.1.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.1.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.1.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.1.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.1.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.1.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.1.8:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.1.9:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.2.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.2.10:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.2.11:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.2.12:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.2.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.2.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.2.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.2.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.2.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.2.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.2.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.2.8:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.2.9:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.3.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.3.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.3.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.3.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.3.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.3.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.3.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.3.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.3.8:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.4.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.4.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.4.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.4.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.4.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.4.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.4.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.4.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.4.8:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.5.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.5.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.5.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.5.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.5.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.5.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.5.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.5.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.5.8:*:*:*:*:*:*:*",
		"cpe:2.3:a:codeigniter:codeigniter:4.6.0:*:*:*:*:*:*:*"
	]
}
