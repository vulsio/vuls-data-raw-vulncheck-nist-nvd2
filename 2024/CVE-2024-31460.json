{
	"id": "CVE-2024-31460",
	"sourceIdentifier": "security-advisories@github.com",
	"vulnStatus": "Analyzed",
	"published": "2024-05-14T15:25:26.897",
	"lastModified": "2024-12-18T20:38:39.747",
	"descriptions": [
		{
			"lang": "en",
			"value": "Cacti provides an operational monitoring and fault management framework. Prior to version 1.2.27, some of the data stored in `automation_tree_rules.php` is not thoroughly checked and is used to concatenate the SQL statement in `create_all_header_nodes()`  function from `lib/api_automation.php` , finally resulting in SQL injection. Using SQL based secondary injection technology, attackers can modify the contents of the Cacti database, and based on the modified content, it may be possible to achieve further impact, such as arbitrary file reading, and even remote code execution through arbitrary file writing. Version 1.2.27 contains a patch for the issue."
		},
		{
			"lang": "es",
			"value": "Cacti proporciona un framework de monitoreo operativo y gestión de fallas. Antes de la versión 1.2.27, algunos de los datos almacenados en `automation_tree_rules.php` no se verifican minuciosamente y se usan para concatenar la declaración SQL en la función `create_all_header_nodes()` de `lib/api_automation.php`, lo que finalmente da como resultado SQL inyección. Al utilizar la tecnología de inyección secundaria basada en SQL, los atacantes pueden modificar el contenido de la base de datos de Cacti y, en función del contenido modificado, es posible lograr un mayor impacto, como la lectura de archivos arbitrarios e incluso la ejecución remota de código mediante la escritura de archivos arbitrarios. La versión 1.2.27 contiene un parche para el problema."
		}
	],
	"references": [
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Exploit",
				"Vendor Advisory"
			],
			"url": "https://github.com/Cacti/cacti/security/advisories/GHSA-cx8g-hvq8-p2rv"
		},
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Exploit",
				"Vendor Advisory"
			],
			"url": "https://github.com/Cacti/cacti/security/advisories/GHSA-gj3f-p326-gh8r"
		},
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Product"
			],
			"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/RBEOAFKRARQHTDIYSL723XAFJ2Q6624X/"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Exploit",
				"Vendor Advisory"
			],
			"url": "https://github.com/Cacti/cacti/security/advisories/GHSA-cx8g-hvq8-p2rv"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Exploit",
				"Vendor Advisory"
			],
			"url": "https://github.com/Cacti/cacti/security/advisories/GHSA-gj3f-p326-gh8r"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Product"
			],
			"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/RBEOAFKRARQHTDIYSL723XAFJ2Q6624X/"
		}
	],
	"metrics": {
		"cvssMetricV31": [
			{
				"source": "security-advisories@github.com",
				"type": "Secondary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N",
					"attackVector": "NETWORK",
					"attackComplexity": "LOW",
					"privilegesRequired": "LOW",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "NONE",
					"integrityImpact": "HIGH",
					"availabilityImpact": "NONE",
					"baseScore": 6.5,
					"baseSeverity": "MEDIUM"
				},
				"exploitabilityScore": 2.8,
				"impactScore": 3.6
			},
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
					"attackVector": "NETWORK",
					"attackComplexity": "LOW",
					"privilegesRequired": "LOW",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "HIGH",
					"integrityImpact": "HIGH",
					"availabilityImpact": "HIGH",
					"baseScore": 8.8,
					"baseSeverity": "HIGH"
				},
				"exploitabilityScore": 2.8,
				"impactScore": 5.9
			}
		]
	},
	"weaknesses": [
		{
			"source": "security-advisories@github.com",
			"type": "Secondary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-89"
				}
			]
		},
		{
			"source": "nvd@nist.gov",
			"type": "Primary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-89"
				}
			]
		}
	],
	"configurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:cacti:cacti:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "47529989-64EF-4CBB-AF1D-28A7C1CF36B3",
							"versionEndExcluding": "1.2.27"
						}
					]
				}
			]
		},
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:o:fedoraproject:fedora:39:*:*:*:*:*:*:*",
							"matchCriteriaId": "B8EDB836-4E6A-4B71-B9B2-AA3E03E0F646"
						}
					]
				}
			]
		}
	],
	"vcConfigurations": [
		{
			"nodes": [
				{
					"operator": "",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:cacti:cacti:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "",
							"versionEndIncluding": "1.2.26"
						}
					]
				}
			]
		}
	],
	"vcVulnerableCPEs": [
		"cpe:2.3:a:cacti:cacti:0.8.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8.2a:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8.3a:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8.5a:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8.6a:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8.6b:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8.6c:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8.6d:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8.6e:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8.6f:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8.6g:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8.6h:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8.6i:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8.6j:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8.6k:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8.7a:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8.7b:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8.7c:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8.7d:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8.7e:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8.7f:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8.7g:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8.7h:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8.7i:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8.8:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8.8a:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8.8b:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8.8c:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8.8d:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8.8e:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8.8f:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8.8g:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8.8h:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:0.8:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.0.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.0.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.0.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.0.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.0.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.0.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.0.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.10:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.11:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.12:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.13:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.14:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.15:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.16:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.17:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.18:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.19:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.20:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.21:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.22:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.23:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.24:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.25:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.26:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.27:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.28:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.29:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.30:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.31:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.32:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.33:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.34:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.35:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.36:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.37:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.38:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.8:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.1.9:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.2.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.2.0:-:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.2.0:beta1:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.2.0:beta2:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.2.0:beta3:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.2.0:beta4:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.2.10:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.2.11:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.2.12:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.2.13:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.2.14:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.2.15:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.2.16:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.2.17:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.2.18:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.2.19:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.2.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.2.20:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.2.21:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.2.22:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.2.23:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.2.24:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.2.25:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.2.26:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.2.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.2.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.2.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.2.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.2.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.2.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.2.8:*:*:*:*:*:*:*",
		"cpe:2.3:a:cacti:cacti:1.2.9:*:*:*:*:*:*:*"
	]
}
