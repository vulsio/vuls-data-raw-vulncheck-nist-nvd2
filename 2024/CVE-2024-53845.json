{
	"id": "CVE-2024-53845",
	"sourceIdentifier": "security-advisories@github.com",
	"vulnStatus": "Awaiting Analysis",
	"published": "2024-12-12T02:15:29.087",
	"lastModified": "2024-12-12T02:15:29.087",
	"descriptions": [
		{
			"lang": "en",
			"value": "ESPTouch is a connection protocol for internet of things devices. In the ESPTouchV2 protocol, while there is an option to use a custom AES key, there is no option to set the IV (Initialization Vector) prior to versions 5.3.2, 5.2.4, 5.1.6, and 5.0.8. The IV is set to zero and remains constant throughout the product's lifetime. In AES/CBC mode, if the IV is not properly initialized, the encrypted output becomes deterministic, leading to potential data leakage. To address the aforementioned issues, the application generates a random IV when activating the AES key starting in versions 5.3.2, 5.2.4, 5.1.6, and 5.0.8. This IV is then transmitted along with the provision data to the provision device. The provision device has also been equipped with a parser for the AES IV. The upgrade is applicable for all applications and users of ESPTouch v2 component from ESP-IDF. As it is implemented in the ESP Wi-Fi stack, there is no workaround for the user to fix the application layer without upgrading the underlying firmware."
		},
		{
			"lang": "es",
			"value": "ESPTouch es un protocolo de conexión para dispositivos de Internet de las cosas. En el protocolo ESPTouchV2, si bien existe una opción para usar una clave AES personalizada, no existe una opción para configurar el IV (vector de inicialización) en versiones anteriores a 5.3.2, 5.2.4, 5.1.6 y 5.0.8. El IV se configura en cero y permanece constante durante toda la vida útil del producto. En el modo AES/CBC, si el IV no se inicializa correctamente, la salida cifrada se vuelve determinista, lo que genera una posible fuga de datos. Para solucionar los problemas mencionados anteriormente, la aplicación genera un IV aleatorio al activar la clave AES a partir de las versiones 5.3.2, 5.2.4, 5.1.6 y 5.0.8. Luego, este IV se transmite junto con los datos de provisión al dispositivo de provisión. El dispositivo de provisión también ha sido equipado con un analizador para el IV AES. La actualización es aplicable para todas las aplicaciones y usuarios del componente ESPTouch v2 de ESP-IDF. Como está implementado en la pila Wi-Fi ESP, no existe ninguna solución alternativa para que el usuario arregle la capa de aplicación sin actualizar el firmware subyacente."
		}
	],
	"references": [
		{
			"source": "security-advisories@github.com",
			"url": "https://github.com/EspressifApp/EsptouchForAndroid/tree/master/esptouch-v2"
		},
		{
			"source": "security-advisories@github.com",
			"url": "https://github.com/EspressifApp/EsptouchForIOS/tree/master/EspTouchDemo/ESPTouchV2"
		},
		{
			"source": "security-advisories@github.com",
			"url": "https://github.com/espressif/esp-idf/commit/4f85a2726e04b737c8646d865b44ddd837b703db"
		},
		{
			"source": "security-advisories@github.com",
			"url": "https://github.com/espressif/esp-idf/commit/8fb28dcedcc49916a5206456a3a61022d4302cd8"
		},
		{
			"source": "security-advisories@github.com",
			"url": "https://github.com/espressif/esp-idf/commit/d47ed7d6f814e21c5bc8997ab0bc68e2360e5cb2"
		},
		{
			"source": "security-advisories@github.com",
			"url": "https://github.com/espressif/esp-idf/commit/de69895f38d563e22228f5ba23fffa02feabc3a9"
		},
		{
			"source": "security-advisories@github.com",
			"url": "https://github.com/espressif/esp-idf/commit/fd224e83bbf133833638b277c767be7f7cdd97c7"
		},
		{
			"source": "security-advisories@github.com",
			"url": "https://github.com/espressif/esp-idf/security/advisories/GHSA-wm57-466g-mhrr"
		},
		{
			"source": "security-advisories@github.com",
			"url": "https://github.com/espressif/esp-idf/tree/master/components/esp_wifi"
		}
	],
	"metrics": {
		"cvssMetricV40": [
			{
				"source": "security-advisories@github.com",
				"type": "Secondary",
				"cvssData": {
					"version": "4.0",
					"vectorString": "CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N/E:U/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:X/AU:X/R:X/V:X/RE:X/U:X",
					"baseScore": 6.6,
					"baseSeverity": "MEDIUM",
					"attackVector": "NETWORK",
					"attackComplexity": "LOW",
					"attackRequirements": "NONE",
					"privilegesRequired": "NONE",
					"userInteraction": "NONE",
					"exploitMaturity": "UNREPORTED",
					"modifiedAttackVector": "NOT_DEFINED",
					"modifiedAttackComplexity": "NOT_DEFINED",
					"modifiedAttackRequirements": "NOT_DEFINED",
					"modifiedPrivilegesRequired": "NOT_DEFINED",
					"modifiedUserInteraction": "NOT_DEFINED",
					"safety": "NOT_DEFINED",
					"automatable": "NOT_DEFINED",
					"providerUrgency": "NOT_DEFINED",
					"recovery": "NOT_DEFINED",
					"valueDensity": "NOT_DEFINED",
					"vulnerabilityResponseEffort": "NOT_DEFINED"
				}
			}
		]
	},
	"weaknesses": [
		{
			"source": "security-advisories@github.com",
			"type": "Primary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-327"
				},
				{
					"lang": "en",
					"value": "CWE-909"
				}
			]
		}
	],
	"vcConfigurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:espressif:esp-idf:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "",
							"versionEndExcluding": "5.0.8"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:espressif:esp-idf:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "",
							"versionStartIncluding": "5.1.0",
							"versionEndExcluding": "5.1.6"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:espressif:esp-idf:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "",
							"versionStartIncluding": "5.2.0",
							"versionEndExcluding": "5.2.4"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:espressif:esp-idf:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "",
							"versionStartIncluding": "5.3.0",
							"versionEndExcluding": "5.3.2"
						}
					]
				}
			]
		}
	],
	"vcVulnerableCPEs": [
		"cpe:2.3:a:espressif:esp-idf:0.9:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:1.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:2.0.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:2.0:-:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:2.0:rc1:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:2.0:rc2:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:2.1.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:2.1:-:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:2.1:rc1:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.0.1:-:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.0.1:rc:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.0.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.0.3:-:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.0.3:rc:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.0.4:-:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.0.4:rc1:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.0.5:-:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.0.5:rc:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.0.6:-:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.0.6:rc:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.0.7:-:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.0.7:rc:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.0.8:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.0.9:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.0:-:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.0:rc1:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.1.1:-:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.1.1:rc2:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.1.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.1.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.1.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.1.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.1.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.1.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.1:-:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.1:beta1:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.1:rc1:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.1:rc2:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.2.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.2.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.2.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.2:-:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.2:beta1:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.2:beta3:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.2:rc:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.3.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.3.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.3.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.3.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.3:-:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.3:beta1:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.3:beta2:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.3:beta3:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:3.3:rc:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:4.0.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:4.0.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:4.0.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:4.0.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:4.0:-:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:4.0:beta1:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:4.0:beta2:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:4.0:dev:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:4.0:rc:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:4.1.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:4.1.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:4.1.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:4.1.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:4.1:-:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:4.1:beta1:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:4.1:beta2:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:4.1:dev:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:4.1:rc:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:4.2.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:4.2.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:4.2.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:4.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:4.2:beta1:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:4.2:dev:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:4.3.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:4.3:-:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:4.3:beta1:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:4.3:beta2:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:4.3:beta3:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:4.3:dev:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:4.3:rc:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:4.4.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:4.4.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:4.4:dev:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:5.0.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:5.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:5.1.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:5.1.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:5.2.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:5.2.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:espressif:esp-idf:5.3.0:*:*:*:*:*:*:*"
	]
}
