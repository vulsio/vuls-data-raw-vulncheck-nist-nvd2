{
	"id": "CVE-2024-6868",
	"sourceIdentifier": "security@huntr.dev",
	"vulnStatus": "Analyzed",
	"published": "2024-10-29T13:15:08.473",
	"lastModified": "2024-11-13T14:43:33.037",
	"descriptions": [
		{
			"lang": "en",
			"value": "mudler/LocalAI version 2.17.1 allows for arbitrary file write due to improper handling of automatic archive extraction. When model configurations specify additional files as archives (e.g., .tar), these archives are automatically extracted after downloading. This behavior can be exploited to perform a 'tarslip' attack, allowing files to be written to arbitrary locations on the server, bypassing checks that normally restrict files to the models directory. This vulnerability can lead to remote code execution (RCE) by overwriting backend assets used by the server."
		},
		{
			"lang": "es",
			"value": "La versión 2.17.1 de mudler/LocalAI permite la escritura arbitraria de archivos debido al manejo inadecuado de la extracción automática de archivos. Cuando las configuraciones de modelos especifican archivos adicionales como archivos (por ejemplo, .tar), estos archivos se extraen automáticamente después de la descarga. Este comportamiento se puede aprovechar para realizar un ataque \"tarslip\", que permite escribir archivos en ubicaciones arbitrarias en el servidor, evitando las comprobaciones que normalmente restringen los archivos al directorio de modelos. Esta vulnerabilidad puede provocar la ejecución remota de código (RCE) al sobrescribir los activos del backend utilizados por el servidor."
		}
	],
	"references": [
		{
			"source": "security@huntr.dev",
			"tags": [
				"Patch"
			],
			"url": "https://github.com/mudler/localai/commit/a181dd0ebc5d3092fc50f61674d552604fe8ef9c"
		},
		{
			"source": "security@huntr.dev",
			"tags": [
				"Exploit",
				"Third Party Advisory"
			],
			"url": "https://huntr.com/bounties/752d2376-2d9a-4e17-b462-3c267f9dd229"
		}
	],
	"metrics": {
		"cvssMetricV30": [
			{
				"source": "security@huntr.dev",
				"type": "Secondary",
				"cvssData": {
					"version": "3.0",
					"vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H",
					"attackVector": "NETWORK",
					"attackComplexity": "LOW",
					"privilegesRequired": "LOW",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "NONE",
					"integrityImpact": "HIGH",
					"availabilityImpact": "HIGH",
					"baseScore": 8.1,
					"baseSeverity": "HIGH",
					"temporalScore": 0,
					"environmentalScore": 0
				},
				"exploitabilityScore": 2.8,
				"impactScore": 5.2
			}
		],
		"cvssMetricV31": [
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
					"attackVector": "NETWORK",
					"attackComplexity": "LOW",
					"privilegesRequired": "NONE",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "HIGH",
					"integrityImpact": "HIGH",
					"availabilityImpact": "HIGH",
					"baseScore": 9.8,
					"baseSeverity": "CRITICAL"
				},
				"exploitabilityScore": 3.9,
				"impactScore": 5.9
			}
		]
	},
	"weaknesses": [
		{
			"source": "security@huntr.dev",
			"type": "Secondary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-20"
				}
			]
		},
		{
			"source": "nvd@nist.gov",
			"type": "Primary",
			"description": [
				{
					"lang": "en",
					"value": "NVD-CWE-noinfo"
				}
			]
		}
	],
	"configurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:mudler:localai:2.17.1:*:*:*:*:*:*:*",
							"matchCriteriaId": "CDCAF2D5-46FD-4D8E-B65B-9BE9FDD5D686"
						}
					]
				}
			]
		}
	],
	"vcConfigurations": [
		{
			"nodes": [
				{
					"operator": "",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:mudler:localai:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "",
							"versionEndExcluding": "2.18.1"
						}
					]
				}
			]
		}
	],
	"vcVulnerableCPEs": [
		"cpe:2.3:a:mudler:localai:0.10.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:0.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:0.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:0.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:0.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:0.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:0.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:0.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:0.8.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:0.8:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:0.9.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:0.9.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:0.9:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.1.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.10.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.10.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.11.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.11.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.12.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.13.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.14.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.14.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.14.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.15.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.16.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.17.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.17.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.18.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.19.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.19.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.19.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.2.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.20.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.20.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.21.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.22.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.23.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.23.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.23.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.24.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.24.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.25.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.3.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.3.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.3.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.30.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.4.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.40.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.5.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.5.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.6.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.6.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.6.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.6.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.7.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.7.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.8.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.8.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.9.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:1.9.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:2.0.0:-:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:2.0.0:beta:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:2.1.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:2.10.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:2.10.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:2.11.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:2.12.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:2.12.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:2.12.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:2.12.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:2.13.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:2.14.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:2.15.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:2.16.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:2.17.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:2.17.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:2.17:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:2.18.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:2.2.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:2.3.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:2.3.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:2.4.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:2.4.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:2.5.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:2.5.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:2.6.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:2.6.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:2.7.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:2.8.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:2.8.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:2.8.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:mudler:localai:2.9.0:*:*:*:*:*:*:*"
	]
}
