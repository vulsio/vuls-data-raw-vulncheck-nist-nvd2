{
	"id": "CVE-2024-32647",
	"sourceIdentifier": "security-advisories@github.com",
	"vulnStatus": "Analyzed",
	"published": "2024-04-25T18:15:08.963",
	"lastModified": "2025-01-02T22:46:37.853",
	"descriptions": [
		{
			"lang": "en",
			"value": "Vyper is a pythonic Smart Contract Language for the Ethereum virtual machine. In versions 0.3.10 and prior, using the `create_from_blueprint` builtin can result in a double eval vulnerability when `raw_args=True` and the `args` argument has side-effects. It can be seen that the `_build_create_IR` function of the `create_from_blueprint` builtin doesn't cache the mentioned `args` argument to the stack. As such, it can be evaluated multiple times (instead of retrieving the value from the stack). No vulnerable production contracts were found. Additionally, double evaluation of side-effects should be easily discoverable in client tests. As such, the impact is low. As of time of publication, no fixed versions exist.\n"
		},
		{
			"lang": "es",
			"value": "Vyper es un lenguaje de contrato inteligente pitónico para la máquina virtual Ethereum. En las versiones 0.3.10 y anteriores, el uso de la función incorporada `create_from_blueprint` puede resultar en una vulnerabilidad de doble evaluación cuando `raw_args=True` y el argumento `args` tienen efectos secundarios. Se puede ver que la función `_build_create_IR` del incorporado `create_from_blueprint` no almacena en caché el argumento `args` mencionado en la pila. Como tal, se puede evaluar varias veces (en lugar de recuperar el valor de la pila). No se encontraron contratos de producción vulnerables. Además, la doble evaluación de los efectos secundarios debería poder descubrirse fácilmente en las pruebas de los clientes. Como tal, el impacto es bajo. Al momento de la publicación, no existen versiones fijas."
		}
	],
	"references": [
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Product"
			],
			"url": "https://github.com/vyperlang/vyper/blob/cedf7087e68e67c7bfbd47ae95dcb16b81ad2e02/vyper/builtins/functions.py#L1847"
		},
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Vendor Advisory"
			],
			"url": "https://github.com/vyperlang/vyper/security/advisories/GHSA-3whq-64q2-qfj6"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Product"
			],
			"url": "https://github.com/vyperlang/vyper/blob/cedf7087e68e67c7bfbd47ae95dcb16b81ad2e02/vyper/builtins/functions.py#L1847"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Vendor Advisory"
			],
			"url": "https://github.com/vyperlang/vyper/security/advisories/GHSA-3whq-64q2-qfj6"
		}
	],
	"metrics": {
		"cvssMetricV31": [
			{
				"source": "security-advisories@github.com",
				"type": "Secondary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N",
					"attackVector": "NETWORK",
					"attackComplexity": "LOW",
					"privilegesRequired": "NONE",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "NONE",
					"integrityImpact": "LOW",
					"availabilityImpact": "NONE",
					"baseScore": 5.3,
					"baseSeverity": "MEDIUM"
				},
				"exploitabilityScore": 3.9,
				"impactScore": 1.4
			},
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N",
					"attackVector": "NETWORK",
					"attackComplexity": "LOW",
					"privilegesRequired": "NONE",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "NONE",
					"integrityImpact": "LOW",
					"availabilityImpact": "NONE",
					"baseScore": 5.3,
					"baseSeverity": "MEDIUM"
				},
				"exploitabilityScore": 3.9,
				"impactScore": 1.4
			}
		]
	},
	"weaknesses": [
		{
			"source": "security-advisories@github.com",
			"type": "Secondary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-95"
				}
			]
		},
		{
			"source": "nvd@nist.gov",
			"type": "Primary",
			"description": [
				{
					"lang": "en",
					"value": "NVD-CWE-Other"
				}
			]
		}
	],
	"configurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:vyperlang:vyper:*:*:*:*:*:python:*:*",
							"matchCriteriaId": "CEC5BCE2-DB5C-49EB-A302-F11E4E02F9BD",
							"versionEndExcluding": "0.4.0"
						}
					]
				}
			]
		}
	],
	"vcConfigurations": [
		{
			"nodes": [
				{
					"operator": "",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:vyperlang:vyper:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "",
							"versionEndExcluding": "0.4.0"
						}
					]
				}
			]
		}
	],
	"vcVulnerableCPEs": [
		"cpe:2.3:a:vyperlang:vyper:0.0.4:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.1.0:beta10:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.1.0:beta11:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.1.0:beta12:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.1.0:beta13:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.1.0:beta14:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.1.0:beta15:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.1.0:beta16:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.1.0:beta17:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.1.0:beta1:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.1.0:beta2:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.1.0:beta3:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.1.0:beta4:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.1.0:beta5:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.1.0:beta6:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.1.0:beta7:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.1.0:beta8:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.1.0:beta9:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.0:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.10:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.11:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.12:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.13:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.14:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.15:*:*:*:*:*:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.15:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.16:*:*:*:*:*:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.16:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.1:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.2:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.3:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.4:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.5:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.6:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.7:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.8:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.9:*:*:*:*:*:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.9:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.3.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.3.0:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.3.10:*:*:*:*:*:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.3.10:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.3.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.3.1:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.3.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.3.2:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.3.3:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.3.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.3.4:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.3.5:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.3.6:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.3.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.3.7:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.3.8:*:*:*:*:*:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.3.8:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.3.9:*:*:*:*:*:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.3.9:*:*:*:*:python:*:*"
	]
}
