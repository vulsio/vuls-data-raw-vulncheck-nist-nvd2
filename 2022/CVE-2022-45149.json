{
	"id": "CVE-2022-45149",
	"sourceIdentifier": "patrick@puiterwijk.org",
	"vulnStatus": "Modified",
	"published": "2022-11-23T15:15:10.803",
	"lastModified": "2025-04-25T20:15:35.880",
	"descriptions": [
		{
			"lang": "en",
			"value": "A vulnerability was found in Moodle which exists due to insufficient validation of the HTTP request origin in course redirect URL. A user's CSRF token was unnecessarily included in the URL when being redirected to a course they have just restored. A remote attacker can trick the victim to visit a specially crafted web page and perform arbitrary actions on behalf of the victim on the vulnerable website. This flaw allows an attacker to perform cross-site request forgery attacks."
		},
		{
			"lang": "es",
			"value": "Se encontró una vulnerabilidad en Moodle que existe debido a una validación insuficiente del origen de la solicitud HTTP en la URL de redireccionamiento del curso. El token CSRF de un usuario se incluyó innecesariamente en la URL cuando se le redirigió a un curso que acababa de restaurar. Un atacante remoto puede engañar a la víctima para que visite una página web especialmente manipulada y realizar acciones arbitrarias en nombre de la víctima en el sitio web vulnerable. Esta falla permite a un atacante realizar ataques de Cross-Site Request Forgery (CSRF)."
		}
	],
	"references": [
		{
			"source": "patrick@puiterwijk.org",
			"url": "http://git.moodle.org/gw?p=moodle.git&a=search&h=HEAD&st=commit&s=MDL-75862"
		},
		{
			"source": "patrick@puiterwijk.org",
			"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2142772"
		},
		{
			"source": "patrick@puiterwijk.org",
			"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/2DHYIIAUXUBHMBEDYU7TYNZXEN2W2SA2/"
		},
		{
			"source": "patrick@puiterwijk.org",
			"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/74SXNGA5RIWM7QNX7H3G7SYIQLP4UUGV/"
		},
		{
			"source": "patrick@puiterwijk.org",
			"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/NLRJB5JNKK3VVBLV3NH3RI7COEDAXSAB/"
		},
		{
			"source": "patrick@puiterwijk.org",
			"url": "https://moodle.org/mod/forum/discuss.php?d=440769"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"url": "http://git.moodle.org/gw?p=moodle.git&a=search&h=HEAD&st=commit&s=MDL-75862"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2142772"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/2DHYIIAUXUBHMBEDYU7TYNZXEN2W2SA2/"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/74SXNGA5RIWM7QNX7H3G7SYIQLP4UUGV/"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/NLRJB5JNKK3VVBLV3NH3RI7COEDAXSAB/"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"url": "https://moodle.org/mod/forum/discuss.php?d=440769"
		}
	],
	"metrics": {
		"cvssMetricV31": [
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N",
					"attackVector": "NETWORK",
					"attackComplexity": "LOW",
					"privilegesRequired": "NONE",
					"userInteraction": "REQUIRED",
					"scope": "UNCHANGED",
					"confidentialityImpact": "LOW",
					"integrityImpact": "LOW",
					"availabilityImpact": "NONE",
					"baseScore": 5.4,
					"baseSeverity": "MEDIUM"
				},
				"exploitabilityScore": 2.8,
				"impactScore": 2.5
			},
			{
				"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
				"type": "Secondary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N",
					"attackVector": "NETWORK",
					"attackComplexity": "LOW",
					"privilegesRequired": "NONE",
					"userInteraction": "REQUIRED",
					"scope": "UNCHANGED",
					"confidentialityImpact": "LOW",
					"integrityImpact": "LOW",
					"availabilityImpact": "NONE",
					"baseScore": 5.4,
					"baseSeverity": "MEDIUM"
				},
				"exploitabilityScore": 2.8,
				"impactScore": 2.5
			}
		]
	},
	"weaknesses": [
		{
			"source": "patrick@puiterwijk.org",
			"type": "Secondary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-352"
				}
			]
		},
		{
			"source": "nvd@nist.gov",
			"type": "Primary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-352"
				}
			]
		}
	],
	"configurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:moodle:moodle:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "9D765451-92A9-48B2-B921-38F91C9398BD",
							"versionStartIncluding": "3.9.0",
							"versionEndExcluding": "3.9.18"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:moodle:moodle:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "2DCA83CE-4355-4427-A57B-0DDF29796198",
							"versionStartIncluding": "3.11.0",
							"versionEndExcluding": "3.11.11"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:moodle:moodle:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "1A232EF3-5AE4-4091-82DE-492B1F57F3B0",
							"versionStartIncluding": "4.0.0",
							"versionEndExcluding": "4.0.5"
						}
					]
				}
			]
		},
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:*",
							"matchCriteriaId": "80E516C0-98A4-4ADE-B69F-66A772E2BAAA"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:o:fedoraproject:fedora:36:*:*:*:*:*:*:*",
							"matchCriteriaId": "5C675112-476C-4D7C-BCB9-A2FB2D0BC9FD"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:o:fedoraproject:fedora:37:*:*:*:*:*:*:*",
							"matchCriteriaId": "E30D0E6F-4AE8-4284-8716-991DFA48CC5D"
						}
					]
				}
			]
		}
	],
	"vcConfigurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:moodle:moodle:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "",
							"versionStartIncluding": "3.11.0",
							"versionEndExcluding": "3.11.11"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:moodle:moodle:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "",
							"versionStartIncluding": "3.9.0",
							"versionEndExcluding": "3.9.18"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:moodle:moodle:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "",
							"versionStartIncluding": "4.0.0",
							"versionEndExcluding": "4.0.5"
						}
					]
				}
			]
		}
	],
	"vcVulnerableCPEs": [
		"cpe:2.3:a:moodle:moodle:3.11.0-beta:*:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.11.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.11.0:-:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.11.0:beta:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.11.0:rc1:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.11.0:rc2:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.11.10:*:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.11.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.11.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.11.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.11.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.11.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.11.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.11.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.11.8:*:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.11.9:*:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.9.0-beta:*:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.9.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.9.0:-:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.9.0:beta:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.9.0:rc1:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.9.0:rc2:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.9.0:rc3:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.9.10:*:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.9.11:*:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.9.12:*:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.9.13:*:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.9.14:*:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.9.15:*:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.9.16:*:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.9.17:*:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.9.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.9.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.9.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.9.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.9.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.9.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.9.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.9.8:*:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:3.9.9:*:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:4.0.0-beta:*:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:4.0.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:4.0.0:-:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:4.0.0:beta:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:4.0.0:rc1:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:4.0.0:rc2:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:4.0.0:rc3:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:4.0.0:rc4:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:4.0.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:4.0.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:4.0.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:moodle:moodle:4.0.4:*:*:*:*:*:*:*"
	]
}
