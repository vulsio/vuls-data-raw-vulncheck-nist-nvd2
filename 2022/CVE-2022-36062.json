{
	"id": "CVE-2022-36062",
	"sourceIdentifier": "security-advisories@github.com",
	"vulnStatus": "Modified",
	"published": "2022-09-22T18:15:10.307",
	"lastModified": "2024-11-21T07:12:17.783",
	"descriptions": [
		{
			"lang": "en",
			"value": "Grafana is an open-source platform for monitoring and observability. In versions prior to 8.5.13, 9.0.9, and 9.1.6, Grafana is subject to Improper Preservation of Permissions resulting in privilege escalation on some folders where Admin is the only used permission. The vulnerability impacts Grafana instances where RBAC was disabled and enabled afterwards, as the migrations which are translating legacy folder permissions to RBAC permissions do not account for the scenario where the only user permission in the folder is Admin, as a result RBAC adds permissions for Editors and Viewers which allow them to edit and view folders accordingly. This issue has been patched in versions 8.5.13, 9.0.9, and 9.1.6. A workaround when the impacted folder/dashboard is known is to remove the additional permissions manually."
		},
		{
			"lang": "es",
			"value": "Grafana es una plataforma de código abierto para la monitorización y la observación. En versiones anteriores a 8.5.13, 9.0.9 y 9.1.6, Grafana está sujeta a una Preservación inapropiada de Permisos, lo que resulta en una escalada de privilegios en algunas carpetas donde Admin es el único permiso usado. La vulnerabilidad afecta a las instancias de Grafana en las que se deshabilitó RBAC y se habilitó después, ya que las migraciones que traducen los permisos de carpetas heredadas a permisos RBAC no tienen en cuenta el escenario en el que el único permiso de usuario en la carpeta es Admin, como resultado RBAC añade permisos para Editores y Visualizadores que les permiten editar y ver carpetas en consecuencia. Este problema ha sido parcheado en las versiones 8.5.13, 9.0.9 y 9.1.6. Una solución cuando se conoce la carpeta/el tablero afectado es eliminar los permisos adicionales manualmente"
		}
	],
	"references": [
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Patch",
				"Release Notes",
				"Vendor Advisory"
			],
			"url": "https://github.com/grafana/grafana/security/advisories/GHSA-p978-56hq-r492"
		},
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Third Party Advisory"
			],
			"url": "https://security.netapp.com/advisory/ntap-20221215-0001/"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Patch",
				"Release Notes",
				"Vendor Advisory"
			],
			"url": "https://github.com/grafana/grafana/security/advisories/GHSA-p978-56hq-r492"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Third Party Advisory"
			],
			"url": "https://security.netapp.com/advisory/ntap-20221215-0001/"
		}
	],
	"metrics": {
		"cvssMetricV31": [
			{
				"source": "security-advisories@github.com",
				"type": "Secondary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:L",
					"attackVector": "NETWORK",
					"attackComplexity": "LOW",
					"privilegesRequired": "LOW",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "HIGH",
					"integrityImpact": "LOW",
					"availabilityImpact": "LOW",
					"baseScore": 7.6,
					"baseSeverity": "HIGH"
				},
				"exploitabilityScore": 2.8,
				"impactScore": 4.7
			},
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:N",
					"attackVector": "NETWORK",
					"attackComplexity": "LOW",
					"privilegesRequired": "HIGH",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "LOW",
					"integrityImpact": "LOW",
					"availabilityImpact": "NONE",
					"baseScore": 3.8,
					"baseSeverity": "LOW"
				},
				"exploitabilityScore": 1.2,
				"impactScore": 2.5
			}
		]
	},
	"weaknesses": [
		{
			"source": "security-advisories@github.com",
			"type": "Primary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-281"
				}
			]
		}
	],
	"configurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:grafana:grafana:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "60D90629-8174-4FC3-8D43-17655EF93F5E",
							"versionEndExcluding": "8.5.13"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:grafana:grafana:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "FD0963EA-4EDA-417B-9CF2-609E4157AD8C",
							"versionStartIncluding": "9.0.0",
							"versionEndExcluding": "9.0.9"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:grafana:grafana:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "E40D636D-3D90-46E1-84F2-13F186F55DB7",
							"versionStartIncluding": "9.1.0",
							"versionEndExcluding": "9.1.6"
						}
					]
				}
			]
		}
	],
	"vcConfigurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:grafana:grafana:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "",
							"versionStartIncluding": "8.5.0",
							"versionEndExcluding": "8.5.13"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:grafana:grafana:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "",
							"versionStartIncluding": "9.0.0",
							"versionEndExcluding": "9.0.9"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:grafana:grafana:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "",
							"versionStartIncluding": "9.1.0",
							"versionEndExcluding": "9.1.6"
						}
					]
				}
			]
		}
	],
	"vcVulnerableCPEs": [
		"cpe:2.3:a:grafana:grafana:8.5.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:grafana:grafana:8.5.0:-:*:*:*:*:*:*",
		"cpe:2.3:a:grafana:grafana:8.5.0:beta1:*:*:*:*:*:*",
		"cpe:2.3:a:grafana:grafana:8.5.10:*:*:*:*:*:*:*",
		"cpe:2.3:a:grafana:grafana:8.5.11:*:*:*:*:*:*:*",
		"cpe:2.3:a:grafana:grafana:8.5.12:*:*:*:*:*:*:*",
		"cpe:2.3:a:grafana:grafana:8.5.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:grafana:grafana:8.5.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:grafana:grafana:8.5.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:grafana:grafana:8.5.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:grafana:grafana:8.5.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:grafana:grafana:8.5.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:grafana:grafana:8.5.9:*:*:*:*:*:*:*",
		"cpe:2.3:a:grafana:grafana:9.0.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:grafana:grafana:9.0.0:-:*:*:*:*:*:*",
		"cpe:2.3:a:grafana:grafana:9.0.0:beta1:*:*:*:*:*:*",
		"cpe:2.3:a:grafana:grafana:9.0.0:beta2:*:*:*:*:*:*",
		"cpe:2.3:a:grafana:grafana:9.0.0:beta3:*:*:*:*:*:*",
		"cpe:2.3:a:grafana:grafana:9.0.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:grafana:grafana:9.0.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:grafana:grafana:9.0.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:grafana:grafana:9.0.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:grafana:grafana:9.0.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:grafana:grafana:9.0.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:grafana:grafana:9.0.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:grafana:grafana:9.0.8:*:*:*:*:*:*:*",
		"cpe:2.3:a:grafana:grafana:9.1.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:grafana:grafana:9.1.0:-:*:*:*:*:*:*",
		"cpe:2.3:a:grafana:grafana:9.1.0:beta1:*:*:*:*:*:*",
		"cpe:2.3:a:grafana:grafana:9.1.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:grafana:grafana:9.1.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:grafana:grafana:9.1.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:grafana:grafana:9.1.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:grafana:grafana:9.1.5:*:*:*:*:*:*:*"
	]
}
