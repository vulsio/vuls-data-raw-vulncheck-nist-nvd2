{
	"id": "CVE-2022-29256",
	"sourceIdentifier": "security-advisories@github.com",
	"vulnStatus": "Modified",
	"published": "2022-05-25T22:15:08.307",
	"lastModified": "2024-11-21T06:58:49.207",
	"descriptions": [
		{
			"lang": "en",
			"value": "sharp is an application for Node.js image processing. Prior to version 0.30.5, there is a possible vulnerability in logic that is run only at `npm install` time when installing versions of `sharp` prior to the latest v0.30.5. If an attacker has the ability to set the value of the `PKG_CONFIG_PATH` environment variable in a build environment then they might be able to use this to inject an arbitrary command at `npm install` time. This is not part of any runtime code, does not affect Windows users at all, and is unlikely to affect anyone that already cares about the security of their build environment. This problem is fixed in version 0.30.5."
		},
		{
			"lang": "es",
			"value": "sharp es una aplicación para el procesamiento de imágenes en Node.js. En versiones anteriores a 0.30.5, se presenta una posible vulnerabilidad en la lógica que es ejecutada sólo en el momento de \"npm install\" cuando son instaladas versiones de \"sharp\" anteriores a la última v0.30.5. Si un atacante presenta la capacidad de establecer el valor de la variable de entorno \"PKG_CONFIG_PATH\" en un entorno de construcción, entonces podría ser capaz de usar esto para inyectar un comando arbitrario en el momento de \"npm install\". Esto no es parte de ningún código en tiempo de ejecución, no afecta a usuarios de Windows en absoluto, y es poco probable que afecte a cualquier persona que ya se preocupa por la seguridad de su entorno de construcción. Este problema ha sido corregido en versión 0.30.5"
		}
	],
	"references": [
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Patch",
				"Third Party Advisory"
			],
			"url": "https://github.com/lovell/sharp/commit/a6aeef612be50f5868a77481848b1de674216f0c"
		},
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Patch",
				"Third Party Advisory"
			],
			"url": "https://github.com/lovell/sharp/security/advisories/GHSA-gp95-ppv5-3jc5"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Patch",
				"Third Party Advisory"
			],
			"url": "https://github.com/lovell/sharp/commit/a6aeef612be50f5868a77481848b1de674216f0c"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Patch",
				"Third Party Advisory"
			],
			"url": "https://github.com/lovell/sharp/security/advisories/GHSA-gp95-ppv5-3jc5"
		}
	],
	"metrics": {
		"cvssMetricV2": [
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "2.0",
					"vectorString": "AV:L/AC:L/Au:N/C:P/I:P/A:P",
					"accessVector": "LOCAL",
					"accessComplexity": "LOW",
					"authentication": "NONE",
					"confidentialityImpact": "PARTIAL",
					"integrityImpact": "PARTIAL",
					"availabilityImpact": "PARTIAL",
					"baseScore": 4.6
				},
				"baseSeverity": "MEDIUM",
				"exploitabilityScore": 3.9,
				"impactScore": 6.4
			}
		],
		"cvssMetricV31": [
			{
				"source": "security-advisories@github.com",
				"type": "Secondary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:L/AC:L/PR:H/UI:R/S:U/C:H/I:H/A:H",
					"attackVector": "LOCAL",
					"attackComplexity": "LOW",
					"privilegesRequired": "HIGH",
					"userInteraction": "REQUIRED",
					"scope": "UNCHANGED",
					"confidentialityImpact": "HIGH",
					"integrityImpact": "HIGH",
					"availabilityImpact": "HIGH",
					"baseScore": 6.5,
					"baseSeverity": "MEDIUM"
				},
				"exploitabilityScore": 0.6,
				"impactScore": 5.9
			},
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H",
					"attackVector": "LOCAL",
					"attackComplexity": "LOW",
					"privilegesRequired": "HIGH",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "HIGH",
					"integrityImpact": "HIGH",
					"availabilityImpact": "HIGH",
					"baseScore": 6.7,
					"baseSeverity": "MEDIUM"
				},
				"exploitabilityScore": 0.8,
				"impactScore": 5.9
			}
		]
	},
	"weaknesses": [
		{
			"source": "security-advisories@github.com",
			"type": "Secondary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-77"
				}
			]
		},
		{
			"source": "nvd@nist.gov",
			"type": "Primary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-78"
				}
			]
		}
	],
	"configurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:sharp_project:sharp:*:*:*:*:*:node.js:*:*",
							"matchCriteriaId": "9BE0607B-F1FD-445C-A1BB-447B38FF35EB",
							"versionEndExcluding": "0.30.5"
						}
					]
				}
			]
		}
	],
	"vcConfigurations": [
		{
			"nodes": [
				{
					"operator": "",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:sharp_project:sharp:*:*:*:*:*:node.js:*:*",
							"matchCriteriaId": "",
							"versionEndExcluding": "0.30.5"
						}
					]
				}
			]
		}
	],
	"vcVulnerableCPEs": [
		"cpe:2.3:a:sharp_project:sharp:0.0.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.0.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.0.3:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.0.4:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.0.5:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.0.6:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.0.8:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.0.9:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.1.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.1.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.1.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.1.3:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.1.4:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.1.5:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.1.6:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.1.7:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.1.8:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.10.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.10.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.11.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.11.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.11.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.11.3:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.11.4:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.12.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.12.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.12.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.13.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.13.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.14.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.14.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.15.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.15.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.16.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.16.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.16.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.17.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.17.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.17.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.17.3:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.18.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.18.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.18.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.18.3:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.18.4:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.19.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.19.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.2.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.20.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.20.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.20.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.20.3:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.20.4:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.20.5:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.20.6:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.20.7:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.20.8:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.21.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.21.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.21.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.21.3:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.22.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.22.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.23.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.23.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.23.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.23.3:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.23.4:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.24.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.24.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.25.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.25.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.25.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.25.3:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.25.4:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.26.0:-:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.26.0:alpha1:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.26.0:alpha2:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.26.0:beta1:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.26.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.26.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.26.3:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.27.0:-:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.27.0:beta1:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.27.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.27.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.28.0:-:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.28.0:alpha1:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.28.0:beta1:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.28.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.28.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.28.3:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.29.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.29.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.29.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.29.3:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.3.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.30.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.30.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.30.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.30.3:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.30.4:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.4.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.4.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.4.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.5.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.5.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.5.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.6.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.6.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.6.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.7.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.7.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.7.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.8.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.8.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.8.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.8.3:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.8.4:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.9.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.9.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.9.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:sharp_project:sharp:0.9.3:*:*:*:*:node.js:*:*"
	]
}
