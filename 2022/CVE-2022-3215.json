{
	"id": "CVE-2022-3215",
	"sourceIdentifier": "cve@forums.swift.org",
	"vulnStatus": "Modified",
	"published": "2022-09-28T20:15:17.593",
	"lastModified": "2025-05-20T20:15:23.553",
	"descriptions": [
		{
			"lang": "en",
			"value": "NIOHTTP1 and projects using it for generating HTTP responses can be subject to a HTTP Response Injection attack. This occurs when a HTTP/1.1 server accepts user generated input from an incoming request and reflects it into a HTTP/1.1 response header in some form. A malicious user can add newlines to their input (usually in encoded form) and \"inject\" those newlines into the returned HTTP response. This capability allows users to work around security headers and HTTP/1.1 framing headers by injecting entirely false responses or other new headers. The injected false responses may also be treated as the response to subsequent requests, which can lead to XSS, cache poisoning, and a number of other flaws. This issue was resolved by adding validation to the HTTPHeaders type, ensuring that there's no whitespace incorrectly present in the HTTP headers provided by users. As the existing API surface is non-failable, all invalid characters are replaced by linear whitespace."
		},
		{
			"lang": "es",
			"value": "NIOHTTP1 y los proyectos que lo usan para generar respuestas HTTP pueden ser objeto de un ataque de inyección de respuesta HTTP. Esto ocurre cuando un servidor HTTP/1.1 acepta entradas generadas por el usuario desde una petición entrante y las refleja en un encabezado de respuesta HTTP/1.1 de alguna forma. Un usuario malicioso puede añadir nuevas líneas a su entrada (normalmente en forma codificada) e \"inyectar\" esas nuevas líneas en la respuesta HTTP devuelta. Esta capacidad permite a usuarios eludir los encabezados de seguridad y los encabezados de enmarcado HTTP/1.1 inyectando respuestas completamente falsas u otros encabezados nuevos. Las respuestas falsas inyectadas también pueden ser tratadas como la respuesta a peticiones posteriores, lo que puede conllevar a un ataque de tipo XSS, envenenamiento de la caché y una serie de otros fallos. Este problema ha sido resuelto añadiendo comprobación al tipo HTTPHeaders, asegurando que no se presentan espacios en blanco incorrectos en los encabezados HTTP proporcionadas por los usuarios. Como la superficie de la API existente no es fallida, todos los caracteres no válidos son sustituidos por espacios en blanco lineales"
		}
	],
	"references": [
		{
			"source": "cve@forums.swift.org",
			"tags": [
				"Third Party Advisory"
			],
			"url": "https://github.com/apple/swift-nio/security/advisories/GHSA-7fj7-39wj-c64f"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Third Party Advisory"
			],
			"url": "https://github.com/apple/swift-nio/security/advisories/GHSA-7fj7-39wj-c64f"
		}
	],
	"metrics": {
		"cvssMetricV31": [
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N",
					"attackVector": "NETWORK",
					"attackComplexity": "LOW",
					"privilegesRequired": "NONE",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "NONE",
					"integrityImpact": "HIGH",
					"availabilityImpact": "NONE",
					"baseScore": 7.5,
					"baseSeverity": "HIGH"
				},
				"exploitabilityScore": 3.9,
				"impactScore": 3.6
			},
			{
				"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
				"type": "Secondary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N",
					"attackVector": "NETWORK",
					"attackComplexity": "LOW",
					"privilegesRequired": "NONE",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "NONE",
					"integrityImpact": "HIGH",
					"availabilityImpact": "NONE",
					"baseScore": 7.5,
					"baseSeverity": "HIGH"
				},
				"exploitabilityScore": 3.9,
				"impactScore": 3.6
			}
		]
	},
	"weaknesses": [
		{
			"source": "cve@forums.swift.org",
			"type": "Secondary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-113"
				}
			]
		},
		{
			"source": "nvd@nist.gov",
			"type": "Primary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-74"
				}
			]
		}
	],
	"configurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:apple:swiftnio:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "7DE92207-1814-4053-ABD1-36CFF3BB8BF8",
							"versionEndExcluding": "2.29.1"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:apple:swiftnio:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "42384BB2-84B3-4DCB-A215-4F21D058A833",
							"versionStartIncluding": "2.30.0",
							"versionEndExcluding": "2.39.1"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:apple:swiftnio:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "F1D8C095-CF99-4ED4-96C8-DD0396D5509D",
							"versionStartIncluding": "2.40.0",
							"versionEndExcluding": "2.42.0"
						}
					]
				}
			]
		}
	],
	"vcConfigurations": [
		{
			"nodes": [
				{
					"operator": "",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:apple:swiftnio:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "",
							"versionEndIncluding": "2.41.2"
						}
					]
				}
			]
		}
	],
	"vcVulnerableCPEs": [
		"cpe:2.3:a:apple:swiftnio:1.0.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:1.0.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:1.1.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:1.1.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:1.10.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:1.11.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:1.12.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:1.2.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:1.2.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:1.2.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:1.3.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:1.3.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:1.3.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:1.4.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:1.4.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:1.4.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:1.4.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:1.5.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:1.5.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:1.5.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:1.6.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:1.6.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:1.6.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:1.7.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:1.7.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:1.7.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:1.7.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:1.8.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:1.9.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:1.9.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:1.9.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:1.9.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:1.9.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:1.9.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.13.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.13.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.14.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.15.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.16.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.16.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.17.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.18.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.19.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.20.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.20.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.20.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.21.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.22.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.22.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.23.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.24.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.25.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.25.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.26.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.27.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.28.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.29.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.29.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.30.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.31.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.31.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.31.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.32.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.32.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.32.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.32.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.33.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.34.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.35.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.36.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.37.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.38.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.39.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.39.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.40.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.41.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.41.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apple:swiftnio:2.41.2:*:*:*:*:*:*:*"
	]
}
