{
	"id": "CVE-2022-39263",
	"sourceIdentifier": "security-advisories@github.com",
	"vulnStatus": "Modified",
	"published": "2022-09-28T21:15:14.590",
	"lastModified": "2024-11-21T07:17:54.553",
	"descriptions": [
		{
			"lang": "en",
			"value": "`@next-auth/upstash-redis-adapter` is the Upstash Redis adapter for NextAuth.js, which provides authentication for Next.js. Applications that use `next-auth` Email Provider and `@next-auth/upstash-redis-adapter` before v3.0.2 are affected by this vulnerability. The Upstash Redis adapter implementation did not check for both the identifier (email) and the token, but only checking for the identifier when verifying the token in the email callback flow. An attacker who knows about the victim's email could easily sign in as the victim, given the attacker also knows about the verification token's expired duration. The vulnerability is patched in v3.0.2. A workaround is available. Using Advanced Initialization, developers can check the requests and compare the query's token and identifier before proceeding."
		},
		{
			"lang": "es",
			"value": "\"@next-auth/upstash-redis-adapter\" es el adaptador de Upstash Redis para NextAuth.js, que proporciona autenticación para Next.js. Las aplicaciones que usan el proveedor de correo electrónico \"next-auth\" y \"@next-auth/upstash-redis-adapter\" versiones anteriores a 3.0.2, están afectadas por esta vulnerabilidad. La implementación del adaptador Upstash Redis no comprobaba tanto el identificador (correo electrónico) como el token, sino que sólo comprobaba el identificador cuando verificaba el token en el flujo de devolución de llamada del correo electrónico. Un atacante que conozca el correo electrónico de la víctima podría iniciar sesión fácilmente como la víctima, dado que el atacante también conoce la duración del token de verificación. La vulnerabilidad está parcheada en versión 3.0.2. Se presenta una mitigación disponible. usando la Inicialización Avanzada, los desarrolladores pueden comprobar las peticiones y comparar el token y el identificador de la consulta antes de proceder"
		}
	],
	"references": [
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Patch"
			],
			"url": "https://github.com/nextauthjs/next-auth/commit/d16e04848ee703cf797724194d4ad2907fe125a9"
		},
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Mitigation",
				"Patch",
				"Third Party Advisory"
			],
			"url": "https://github.com/nextauthjs/next-auth/security/advisories/GHSA-4rxr-27mm-mxq9"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Patch"
			],
			"url": "https://github.com/nextauthjs/next-auth/commit/d16e04848ee703cf797724194d4ad2907fe125a9"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Mitigation",
				"Patch",
				"Third Party Advisory"
			],
			"url": "https://github.com/nextauthjs/next-auth/security/advisories/GHSA-4rxr-27mm-mxq9"
		}
	],
	"metrics": {
		"cvssMetricV31": [
			{
				"source": "security-advisories@github.com",
				"type": "Secondary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:N",
					"attackVector": "NETWORK",
					"attackComplexity": "HIGH",
					"privilegesRequired": "NONE",
					"userInteraction": "REQUIRED",
					"scope": "UNCHANGED",
					"confidentialityImpact": "HIGH",
					"integrityImpact": "HIGH",
					"availabilityImpact": "NONE",
					"baseScore": 6.8,
					"baseSeverity": "MEDIUM"
				},
				"exploitabilityScore": 1.6,
				"impactScore": 5.2
			},
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
					"attackVector": "NETWORK",
					"attackComplexity": "HIGH",
					"privilegesRequired": "NONE",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "HIGH",
					"integrityImpact": "HIGH",
					"availabilityImpact": "HIGH",
					"baseScore": 8.1,
					"baseSeverity": "HIGH"
				},
				"exploitabilityScore": 2.2,
				"impactScore": 5.9
			}
		]
	},
	"weaknesses": [
		{
			"source": "security-advisories@github.com",
			"type": "Primary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-287"
				}
			]
		}
	],
	"configurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:nextauth.js:next-auth:*:*:*:*:*:node.js:*:*",
							"matchCriteriaId": "9739A761-9DBD-4177-B34D-AC887CFE81C8",
							"versionEndExcluding": "3.0.2"
						}
					]
				}
			]
		}
	],
	"vcConfigurations": [
		{
			"nodes": [
				{
					"operator": "",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:nextauth.js:next-auth:*:*:*:*:*:node.js:*:*",
							"matchCriteriaId": "",
							"versionEndExcluding": "3.0.2"
						}
					]
				}
			]
		}
	],
	"vcVulnerableCPEs": [
		"cpe:2.3:a:nextauth.js:next-auth:1.0.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:1.1.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:1.1.10:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:1.1.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:1.1.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:1.1.3:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:1.1.5:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:1.1.6:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:1.1.7:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:1.1.8:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:1.1.9:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:1.10.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:1.11.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:1.12.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:1.12.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:1.13.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:1.2.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:1.3.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:1.4.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:1.4.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:1.5.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:1.5.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:1.6.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:1.7.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:1.7.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:1.7.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:1.7.3:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:1.8.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:1.8.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:1.8.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:1.8.3:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:1.8.4:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:1.8.5:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:1.9.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:1.9.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta0:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta10:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta11:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta12:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta13:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta14:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta15:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta16:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta17:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta18:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta19:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta1:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta20:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta21:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta22:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta23:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta24:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta25:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta26:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta27:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta28:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta29:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta2:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta30:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta31:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta32:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta33:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta34:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta35:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta37:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta38:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta39:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta3:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta40:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta41:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta42:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta43:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta44:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta45:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta46:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta47:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta48:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta49:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta4:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta50:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta51:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta52:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta53:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta54:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta55:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta56:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta57:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta58:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta59:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta5:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta60:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta61:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta62:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta63:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta64:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta65:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta66:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta67:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta68:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta69:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta6:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta70:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta71:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta72:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta73:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta74:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta75:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta76:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta77:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta78:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta79:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta7:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta80:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta81:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta82:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta83:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta84:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta85:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta86:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta8:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.0:beta9:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.1.0:-:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.1.0:beta0:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.1.0:beta1:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.2.0:-:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.2.0:beta0:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:2.2.1:beta0:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:3.0.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nextauth.js:next-auth:3.0.1:*:*:*:*:node.js:*:*"
	]
}
