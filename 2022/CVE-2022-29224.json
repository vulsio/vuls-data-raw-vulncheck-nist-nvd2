{
	"id": "CVE-2022-29224",
	"sourceIdentifier": "security-advisories@github.com",
	"vulnStatus": "Modified",
	"published": "2022-06-09T19:15:10.450",
	"lastModified": "2024-11-21T06:58:45.357",
	"descriptions": [
		{
			"lang": "en",
			"value": "Envoy is a cloud-native high-performance proxy. Versions of envoy prior to 1.22.1 are subject to a segmentation fault in the GrpcHealthCheckerImpl. Envoy can perform various types of upstream health checking. One of them uses gRPC. Envoy also has a feature which can “hold” (prevent removal) upstream hosts obtained via service discovery until configured active health checking fails. If an attacker controls an upstream host and also controls service discovery of that host (via DNS, the EDS API, etc.), an attacker can crash Envoy by forcing removal of the host from service discovery, and then failing the gRPC health check request. This will crash Envoy via a null pointer dereference. Users are advised to upgrade to resolve this vulnerability. Users unable to upgrade may disable gRPC health checking and/or replace it with a different health checking type as a mitigation."
		},
		{
			"lang": "es",
			"value": "Envoy es un proxy de alto rendimiento nativo de la nube. Las versiones de Envoy anteriores a 1.22.1 están sujetas a un fallo de segmentación en el GrpcHealthCheckerImpl. Envoy puede llevar a cabo varios tipos de comprobación de la salud de los usuarios. Uno de ellos usa gRPC. Envoy también presenta una función que puede \"retener\" (impedir la eliminación) los hosts upstream obtenidos por medio de la detección de servicios hasta que falle la comprobación de salud activa configurada. Si un atacante controla un host upstream y también controla la detección de servicios de ese host (a través de DNS, la API EDS, etc.), un atacante puede bloquear Envoy al forzar la eliminación del host de la detección de servicios, y luego fallando la petición de comprobación de salud gRPC. Esto bloqueará Envoy por medio de una desreferencia de puntero null. Es recomendado a usuarios actualizar para resolver esta vulnerabilidad. Los usuarios que no puedan actualizar pueden deshabilitar la comprobación de estado de gRPC y/o sustituirla por un tipo de comprobación de estado diferente como medida de mitigación"
		}
	],
	"references": [
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Patch"
			],
			"url": "https://github.com/envoyproxy/envoy/commit/9b1c3962172a972bc0359398af6daa3790bb59db"
		},
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Third Party Advisory"
			],
			"url": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-m4j9-86g3-8f49"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Patch"
			],
			"url": "https://github.com/envoyproxy/envoy/commit/9b1c3962172a972bc0359398af6daa3790bb59db"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Third Party Advisory"
			],
			"url": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-m4j9-86g3-8f49"
		}
	],
	"metrics": {
		"cvssMetricV2": [
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "2.0",
					"vectorString": "AV:N/AC:M/Au:N/C:N/I:N/A:P",
					"accessVector": "NETWORK",
					"accessComplexity": "MEDIUM",
					"authentication": "NONE",
					"confidentialityImpact": "NONE",
					"integrityImpact": "NONE",
					"availabilityImpact": "PARTIAL",
					"baseScore": 4.3
				},
				"baseSeverity": "MEDIUM",
				"exploitabilityScore": 8.6,
				"impactScore": 2.9
			}
		],
		"cvssMetricV31": [
			{
				"source": "security-advisories@github.com",
				"type": "Secondary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
					"attackVector": "NETWORK",
					"attackComplexity": "HIGH",
					"privilegesRequired": "NONE",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "NONE",
					"integrityImpact": "NONE",
					"availabilityImpact": "HIGH",
					"baseScore": 5.9,
					"baseSeverity": "MEDIUM"
				},
				"exploitabilityScore": 2.2,
				"impactScore": 3.6
			},
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
					"attackVector": "NETWORK",
					"attackComplexity": "HIGH",
					"privilegesRequired": "NONE",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "NONE",
					"integrityImpact": "NONE",
					"availabilityImpact": "HIGH",
					"baseScore": 5.9,
					"baseSeverity": "MEDIUM"
				},
				"exploitabilityScore": 2.2,
				"impactScore": 3.6
			}
		]
	},
	"weaknesses": [
		{
			"source": "security-advisories@github.com",
			"type": "Primary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-476"
				}
			]
		}
	],
	"configurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:envoyproxy:envoy:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "343FE7CD-C2BF-42EE-8384-AAD008BE690D",
							"versionEndExcluding": "1.22.1"
						}
					]
				}
			]
		}
	],
	"vcConfigurations": [
		{
			"nodes": [
				{
					"operator": "",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:envoyproxy:envoy:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "",
							"versionEndExcluding": "1.22.1"
						}
					]
				}
			]
		}
	],
	"vcVulnerableCPEs": [
		"cpe:2.3:a:envoyproxy:envoy:1.0.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.1.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.10.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.11.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.11.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.11.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.12.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.12.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.12.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.12.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.12.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.12.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.12.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.12.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.13.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.13.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.13.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.13.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.13.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.13.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.13.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.13.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.13.8:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.14.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.14.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.14.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.14.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.14.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.14.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.14.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.14.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.15.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.15.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.15.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.15.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.15.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.15.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.16.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.16.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.16.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.16.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.16.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.16.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.17.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.17.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.17.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.17.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.17.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.18.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.18.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.18.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.18.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.18.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.18.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.19.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.19.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.19.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.19.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.19.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.2.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.20.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.20.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.20.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.20.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.20.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.20.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.20.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.20.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.21.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.21.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.21.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.21.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.21.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.21.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.21.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.22.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.3.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.4.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.5.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.6.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.7.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.7.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.8.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.9.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.9.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:envoyproxy:envoy:1.9:*:*:*:*:*:*:*"
	]
}
