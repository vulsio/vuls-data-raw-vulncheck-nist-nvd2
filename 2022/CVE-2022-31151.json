{
	"id": "CVE-2022-31151",
	"sourceIdentifier": "security-advisories@github.com",
	"vulnStatus": "Modified",
	"published": "2022-07-21T04:15:12.157",
	"lastModified": "2024-11-21T07:04:00.370",
	"descriptions": [
		{
			"lang": "en",
			"value": "Authorization headers are cleared on cross-origin redirect. However, cookie headers which are sensitive headers and are official headers found in the spec, remain uncleared. There are active users using cookie headers in undici. This may lead to accidental leakage of cookie to a 3rd-party site or a malicious attacker who can control the redirection target (ie. an open redirector) to leak the cookie to the 3rd party site. This was patched in v5.7.1. By default, this vulnerability is not exploitable. Do not enable redirections, i.e. `maxRedirections: 0` (the default)."
		},
		{
			"lang": "es",
			"value": "Los encabezados de autorizaci贸n son borrados en las redirecciones de origen cruzado. Sin embargo, los encabezados de cookies, que son encabezados confidenciales y son encabezados oficiales que son encontrados en la especificaci贸n, permanecen sin limpiar. Se presentan usuarios activos que usan los encabezados de las cookies de forma indiscriminada. Esto puede conllevar a una fuga accidental de la cookie a un sitio de terceros o un atacante malicioso que pueda controlar el objetivo de la redirecci贸n (es decir, un redireccionador abierto) para filtrar la cookie al sitio de terceros. Esto fue parcheado en versi贸n 5.7.1. Por defecto, esta vulnerabilidad no es explotable. No habilite los redireccionamientos, es decir, \"maxRedirections: 0\" (por defecto)"
		}
	],
	"references": [
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Exploit",
				"Issue Tracking",
				"Third Party Advisory"
			],
			"url": "https://github.com/nodejs/undici/issues/872"
		},
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Third Party Advisory"
			],
			"url": "https://github.com/nodejs/undici/security/advisories/GHSA-q768-x9m6-m9qp"
		},
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Permissions Required",
				"Third Party Advisory"
			],
			"url": "https://hackerone.com/reports/1635514"
		},
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Third Party Advisory"
			],
			"url": "https://security.netapp.com/advisory/ntap-20220909-0006/"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Exploit",
				"Issue Tracking",
				"Third Party Advisory"
			],
			"url": "https://github.com/nodejs/undici/issues/872"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Third Party Advisory"
			],
			"url": "https://github.com/nodejs/undici/security/advisories/GHSA-q768-x9m6-m9qp"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Permissions Required",
				"Third Party Advisory"
			],
			"url": "https://hackerone.com/reports/1635514"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Third Party Advisory"
			],
			"url": "https://security.netapp.com/advisory/ntap-20220909-0006/"
		}
	],
	"metrics": {
		"cvssMetricV31": [
			{
				"source": "security-advisories@github.com",
				"type": "Secondary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N",
					"attackVector": "NETWORK",
					"attackComplexity": "HIGH",
					"privilegesRequired": "NONE",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "NONE",
					"integrityImpact": "LOW",
					"availabilityImpact": "NONE",
					"baseScore": 3.7,
					"baseSeverity": "LOW"
				},
				"exploitabilityScore": 2.2,
				"impactScore": 1.4
			},
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N",
					"attackVector": "NETWORK",
					"attackComplexity": "LOW",
					"privilegesRequired": "NONE",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "LOW",
					"integrityImpact": "LOW",
					"availabilityImpact": "NONE",
					"baseScore": 6.5,
					"baseSeverity": "MEDIUM"
				},
				"exploitabilityScore": 3.9,
				"impactScore": 2.5
			}
		]
	},
	"weaknesses": [
		{
			"source": "security-advisories@github.com",
			"type": "Secondary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-601"
				}
			]
		},
		{
			"source": "nvd@nist.gov",
			"type": "Primary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-346"
				}
			]
		}
	],
	"configurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:nodejs:undici:*:*:*:*:*:node.js:*:*",
							"matchCriteriaId": "6CE17D7F-0014-4379-A243-34EA094A0E05",
							"versionEndExcluding": "5.7.1"
						}
					]
				}
			]
		}
	],
	"vcConfigurations": [
		{
			"nodes": [
				{
					"operator": "",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:nodejs:undici:*:*:*:*:*:node.js:*:*",
							"matchCriteriaId": "",
							"versionEndExcluding": "5.8.0"
						}
					]
				}
			]
		}
	],
	"vcVulnerableCPEs": [
		"cpe:2.3:a:nodejs:undici:1.0.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:1.0.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:1.0.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:1.0.3:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:1.1.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:1.2.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:1.2.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:1.2.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:1.2.4:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:1.2.5:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:1.2.6:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:1.3.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:1.3.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:2.0.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:2.0.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:2.0.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:2.0.3:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:2.0.4:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:2.0.5:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:2.0.6:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:2.0.7:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:2.1.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:2.1.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:2.2.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:2.2.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:3.0.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:3.1.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:3.2.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:3.3.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:3.3.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:3.3.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:3.3.3:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:3.3.4:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:3.3.5:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:3.3.6:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.0.0:-:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.0.0:alpha0:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.0.0:alpha1:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.0.0:alpha2:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.0.0:alpha3:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.0.0:alpha4:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.0.0:alpha5:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.0.0:rc1:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.0.0:rc2:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.0.0:rc3:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.0.0:rc4:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.0.0:rc5:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.0.0:rc6:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.0.0:rc7:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.0.0:rc8:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.1.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.1.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.10.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.10.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.10.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.10.3:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.10.4:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.11.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.11.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.11.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.11.3:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.12.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.12.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.12.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.13.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.14.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.14.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.15.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.15.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.16.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.2.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.2.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.2.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.3.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.3.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.4.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.4.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.4.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.4.3:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.4.4:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.4.5:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.4.6:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.4.7:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.5.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.5.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.6.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.7.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.7.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.7.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.7.3:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.8.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.8.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.8.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.9.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.9.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.9.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.9.3:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.9.4:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:4.9.5:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:5.0.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:5.1.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:5.1.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:5.2.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:5.3.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:5.4.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:5.5.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:5.5.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:5.6.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:5.6.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:5.7.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:nodejs:undici:5.7.1:*:*:*:*:node.js:*:*"
	]
}
