{
	"id": "CVE-2022-31166",
	"sourceIdentifier": "security-advisories@github.com",
	"vulnStatus": "Modified",
	"published": "2022-09-07T14:15:08.840",
	"lastModified": "2024-11-21T07:04:02.343",
	"descriptions": [
		{
			"lang": "en",
			"value": "XWiki Platform Old Core is a core package for XWiki Platform, a generic wiki platform. Starting in versions 11.3.7, 11.0.3, and 12.0RC1, it is possible to exploit a bug in XWikiRights resolution of groups to obtain privilege escalation. More specifically, editing a right with the object editor leads to adding a supplementary empty value to groups which is then resolved as a reference to XWiki.WebHome page. Adding an XWikiGroup xobject to that page then transforms it to a group, any user put in that group would then obtain the privileges related to the edited right. Note that this security issue is normally mitigated by the fact that XWiki.WebHome (and XWiki space in general) should be protected by default for edit rights. The problem has been patched in XWiki 13.10.4 and 14.2RC1 to not consider anymore empty values in XWikiRights. It's possible to work around the problem by setting appropriate rights on XWiki.WebHome page to prevent users to edit it."
		},
		{
			"lang": "es",
			"value": "XWiki Platform Old Core es un paquete central para XWiki Platform, una plataforma wiki genérica. A partir de las versiones 11.3.7, 11.0.3 y 12.0RC1, es posible explotar un error en la resolución de grupos de XWikiRights para obtener una escalada de privilegios. Más específicamente, la edición de un derecho con el editor de objetos conlleva a una adición de un valor vacío suplementario a los grupos que luego es resuelto como una referencia a la página XWiki.WebHome. Añadiendo un XWikiGroup xobject a esa página entonces es transformada en un grupo, cualquier usuario puesto en ese grupo obtendría entonces los privilegios relacionados con el derecho editado. Ten en cuenta que este problema de seguridad es mitigado normalmente por el hecho de que XWiki.WebHome (y el espacio XWiki en general) debería estar protegido por defecto para los derechos de edición. El problema ha sido parcheado en XWiki versiones 13.10.4 y 14.2RC1 para no considerar más valores vacíos en XWikiRights. Es posible mitigar el problema al establecer los derechos apropiados en la página XWiki.WebHome para evitar que los usuarios la editen"
		}
	],
	"references": [
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Patch",
				"Third Party Advisory"
			],
			"url": "https://github.com/xwiki/xwiki-platform/pull/1800"
		},
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Third Party Advisory"
			],
			"url": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-g4h6-qp44-wqvx"
		},
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Vendor Advisory"
			],
			"url": "https://jira.xwiki.org/browse/XWIKI-15776"
		},
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Exploit",
				"Permissions Required",
				"Vendor Advisory"
			],
			"url": "https://jira.xwiki.org/browse/XWIKI-18386"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Patch",
				"Third Party Advisory"
			],
			"url": "https://github.com/xwiki/xwiki-platform/pull/1800"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Third Party Advisory"
			],
			"url": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-g4h6-qp44-wqvx"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Vendor Advisory"
			],
			"url": "https://jira.xwiki.org/browse/XWIKI-15776"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Exploit",
				"Permissions Required",
				"Vendor Advisory"
			],
			"url": "https://jira.xwiki.org/browse/XWIKI-18386"
		}
	],
	"metrics": {
		"cvssMetricV31": [
			{
				"source": "security-advisories@github.com",
				"type": "Secondary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N",
					"attackVector": "NETWORK",
					"attackComplexity": "LOW",
					"privilegesRequired": "LOW",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "HIGH",
					"integrityImpact": "HIGH",
					"availabilityImpact": "NONE",
					"baseScore": 8.1,
					"baseSeverity": "HIGH"
				},
				"exploitabilityScore": 2.8,
				"impactScore": 5.2
			},
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
					"attackVector": "NETWORK",
					"attackComplexity": "LOW",
					"privilegesRequired": "LOW",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "HIGH",
					"integrityImpact": "HIGH",
					"availabilityImpact": "HIGH",
					"baseScore": 8.8,
					"baseSeverity": "HIGH"
				},
				"exploitabilityScore": 2.8,
				"impactScore": 5.9
			}
		]
	},
	"weaknesses": [
		{
			"source": "security-advisories@github.com",
			"type": "Secondary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-269"
				}
			]
		},
		{
			"source": "nvd@nist.gov",
			"type": "Primary",
			"description": [
				{
					"lang": "en",
					"value": "NVD-CWE-noinfo"
				}
			]
		}
	],
	"configurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "31CDEDB6-7B92-44DD-8226-B61C9F363C58",
							"versionStartIncluding": "11.3.7",
							"versionEndExcluding": "13.10.4"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "0F5CD5A5-60A9-4621-8F1E-449C54644E40",
							"versionStartIncluding": "14.0",
							"versionEndExcluding": "14.2"
						}
					]
				}
			]
		}
	],
	"vcConfigurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "",
							"versionStartIncluding": "11.3.7",
							"versionEndExcluding": "13.10.4"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "",
							"versionStartIncluding": "14.0-rc-1",
							"versionEndExcluding": "14.2-rc-1"
						}
					]
				}
			]
		}
	],
	"vcVulnerableCPEs": [
		"cpe:2.3:a:xwiki:xwiki:11.10.10:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:11.10.11:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:11.10.12:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:11.10.13:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:11.10.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:11.10.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:11.10.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:11.10.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:11.10.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:11.10.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:11.10.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:11.10.8:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:11.10:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:11.3.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:11.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:11.4:-:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:11.4:rc1:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:11.5:-:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:11.5:rc1:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:11.6-rc-1:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:11.6.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:11.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:11.6:-:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:11.6:rc1:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:11.7:-:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:11.7:rc1:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:11.7RC1:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:11.8-rc-1:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:11.8.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:11.8:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:11.8:-:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:11.8:milestone1:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:11.8:rc1:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:11.9:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.0-rc-1:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.0.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.0:-:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.0:rc1:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.10.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.10.10:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.10.11:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.10.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.10.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.10.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.10.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.10.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.10.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.10.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.10.8:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.10.9:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.10:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.1:-:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.1:rc1:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.2.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.3:-:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.3:rc1:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.4:-:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.4:rc1:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.5-rc-1:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.5.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.5:-:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.5:rc1:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.6.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.6.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.6.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.6.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.6.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.6.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.6.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.6.8:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.7.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.7.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.7:-:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.7:rc1:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.8-rc-1:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.8:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.8:-:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.8:rc1:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.9-rc-1:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.9:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.9:-:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:12.9:rc1:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:13.0.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:13.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:13.10.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:13.10.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:13.10.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:13.10.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:13.10:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:13.10:-:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:13.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:13.1:-:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:13.1:rc1:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:13.1RC1:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:13.2-rc-1:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:13.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:13.2:rc1:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:13.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:13.4-rc-1:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:13.4.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:13.4.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:13.4.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:13.4.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:13.4.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:13.4.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:13.4.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:13.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:13.5-rc-1:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:13.5.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:13.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:13.5:rc1:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:13.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:13.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:13.8:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:13.9-rc-1:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:13.9:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:13.9:-:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:13.9:rc1:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:14.0-rc-1:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:14.0.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:14.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:14.0:-:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:14.0:rc1:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:14.1:-:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:14.1:rc1:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:14.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:14.2:-:*:*:*:*:*:*",
		"cpe:2.3:a:xwiki:xwiki:14.2:rc1:*:*:*:*:*:*"
	]
}
