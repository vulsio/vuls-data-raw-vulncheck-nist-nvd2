{
	"id": "CVE-2022-39338",
	"sourceIdentifier": "security-advisories@github.com",
	"vulnStatus": "Modified",
	"published": "2022-11-25T19:15:11.450",
	"lastModified": "2024-11-21T07:18:04.137",
	"descriptions": [
		{
			"lang": "en",
			"value": "user_oidc is an OpenID Connect user backend for Nextcloud. Versions prior to 1.2.1 did not properly validate discovery urls which may lead to a stored cross site scripting attack vector. The impact is limited due to the restrictive CSP that is applied on this endpoint. Additionally this vulnerability has only been shown to be exploitable in the Safari web browser. This issue has been addressed in version 1.2.1. Users are advised to upgrade. Users unable to upgrade should urge their users to avoid using the Safari web browser."
		},
		{
			"lang": "es",
			"value": "user_oidc es un backend de usuario de OpenID Connect para Nextcloud. Las versiones anteriores a la 1.2.1 no validaban correctamente las URL de descubrimiento, lo que podía provocar un vector de ataque de Cross Site Scripting almacenado. El impacto es limitado debido al CSP restrictivo que se aplica en este endpoint. Además, se ha demostrado que esta vulnerabilidad sólo se puede explotar en el navegador web Safari. Este problema se ha solucionado en la versión 1.2.1. Se recomienda a los usuarios que actualicen. Los usuarios que no puedan actualizar deben instar a sus usuarios a evitar el uso del navegador web Safari."
		}
	],
	"references": [
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Third Party Advisory"
			],
			"url": "https://github.com/nextcloud/security-advisories/security/advisories/GHSA-5fpw-795h-rg57"
		},
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Patch",
				"Third Party Advisory"
			],
			"url": "https://github.com/nextcloud/user_oidc/pull/496"
		},
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Permissions Required",
				"Third Party Advisory"
			],
			"url": "https://hackerone.com/reports/1687410"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Third Party Advisory"
			],
			"url": "https://github.com/nextcloud/security-advisories/security/advisories/GHSA-5fpw-795h-rg57"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Patch",
				"Third Party Advisory"
			],
			"url": "https://github.com/nextcloud/user_oidc/pull/496"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Permissions Required",
				"Third Party Advisory"
			],
			"url": "https://hackerone.com/reports/1687410"
		}
	],
	"metrics": {
		"cvssMetricV31": [
			{
				"source": "security-advisories@github.com",
				"type": "Secondary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:L/I:L/A:N",
					"attackVector": "NETWORK",
					"attackComplexity": "LOW",
					"privilegesRequired": "HIGH",
					"userInteraction": "REQUIRED",
					"scope": "UNCHANGED",
					"confidentialityImpact": "LOW",
					"integrityImpact": "LOW",
					"availabilityImpact": "NONE",
					"baseScore": 3.5,
					"baseSeverity": "LOW"
				},
				"exploitabilityScore": 0.9,
				"impactScore": 2.5
			},
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N",
					"attackVector": "NETWORK",
					"attackComplexity": "LOW",
					"privilegesRequired": "LOW",
					"userInteraction": "REQUIRED",
					"scope": "CHANGED",
					"confidentialityImpact": "LOW",
					"integrityImpact": "LOW",
					"availabilityImpact": "NONE",
					"baseScore": 5.4,
					"baseSeverity": "MEDIUM"
				},
				"exploitabilityScore": 2.3,
				"impactScore": 2.7
			}
		]
	},
	"weaknesses": [
		{
			"source": "security-advisories@github.com",
			"type": "Primary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-20"
				},
				{
					"lang": "en",
					"value": "CWE-79"
				}
			]
		}
	],
	"configurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:nextcloud:openid_connect_user_backend:*:*:*:*:*:nextcloud:*:*",
							"matchCriteriaId": "A6DF3630-82F0-4917-B4CD-8B93EE5DF79B",
							"versionEndExcluding": "1.2.1"
						}
					]
				}
			]
		}
	],
	"vcConfigurations": [
		{
			"nodes": [
				{
					"operator": "",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:nextcloud:notes:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "",
							"versionEndExcluding": "1.2.1"
						}
					]
				}
			]
		}
	],
	"vcVulnerableCPEs": [
		"cpe:2.3:a:nextcloud:notes:0.1.0:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.10.0:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.11.0:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.12.0:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.12.1:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.13.0:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.13.1:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.14.0:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.14.1:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.14.2:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.15.0:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.15.1:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.15.2:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.16.0:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.16.1:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.17.0:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.18.0:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.19.0:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.19.15:*:*:*:*:*:*:*",
		"cpe:2.3:a:nextcloud:notes:0.19.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:nextcloud:notes:0.2.0:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.20.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:nextcloud:notes:0.20.0:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.20.10:*:*:*:*:*:*:*",
		"cpe:2.3:a:nextcloud:notes:0.20.11:*:*:*:*:*:*:*",
		"cpe:2.3:a:nextcloud:notes:0.21.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:nextcloud:notes:0.21.0:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.21.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:nextcloud:notes:0.21.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:nextcloud:notes:0.22.0:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.22.1:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.22.2:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.22.3:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.22.4:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.23.0:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.24.0:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.24.1:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.24.2:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.24.3:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.25.0:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.26.0:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.27.0:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.27.1:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.3.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:nextcloud:notes:0.3.0:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.4.0:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.5.0:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.5.1:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.5.2:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.5:*:*:*:*:nextcloud:*:*",
		"cpe:2.3:a:nextcloud:notes:0.6.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:nextcloud:notes:0.6.0:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.6:*:*:*:*:nextcloud:*:*",
		"cpe:2.3:a:nextcloud:notes:0.7.0:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.7.1:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.7.2:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.7:*:*:*:*:nextcloud:*:*",
		"cpe:2.3:a:nextcloud:notes:0.8.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:nextcloud:notes:0.8.0:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.8.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:nextcloud:notes:0.8.1:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.8:*:*:*:*:nextcloud:*:*",
		"cpe:2.3:a:nextcloud:notes:0.9.0:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:0.9:*:*:*:*:nextcloud:*:*",
		"cpe:2.3:a:nextcloud:notes:1.0.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:nextcloud:notes:1.0.0:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:1.0.0:*:*:*:*:nextcloud:*:*",
		"cpe:2.3:a:nextcloud:notes:1.0.1:*:*:*:*:android:*:*",
		"cpe:2.3:a:nextcloud:notes:1.1.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:nextcloud:notes:1.1.0:*:*:*:*:nextcloud:*:*",
		"cpe:2.3:a:nextcloud:notes:1.1.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:nextcloud:notes:1.2.0:*:*:*:*:*:*:*"
	]
}
