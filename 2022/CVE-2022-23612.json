{
	"id": "CVE-2022-23612",
	"sourceIdentifier": "security-advisories@github.com",
	"vulnStatus": "Modified",
	"published": "2022-02-22T23:15:11.400",
	"lastModified": "2024-11-21T06:48:55.907",
	"descriptions": [
		{
			"lang": "en",
			"value": "OpenMRS is a patient-based medical record system focusing on giving providers a free customizable electronic medical record system. Affected versions are subject to arbitrary file exfiltration due to failure to sanitize request when satisfying GET requests for `/images` & `/initfilter/scripts`. This can allow an attacker to access any file on a system running OpenMRS that is accessible to the user id OpenMRS is running under. Affected implementations should update to the latest patch version of OpenMRS Core for the minor version they use. These are: 2.1.5, 2.2.1, 2.3.5, 2.4.5 and 2.5.3. As a general rule, this vulnerability is already mitigated by Tomcat's URL normalization in Tomcat 7.0.28+. Users on older versions of Tomcat should consider upgrading their Tomcat instance as well as their OpenMRS instance."
		},
		{
			"lang": "es",
			"value": "OpenMRS es un sistema de registro médico basado en el paciente que se centra en ofrecer a los proveedores un sistema de registro médico electrónico gratuito y personalizable. Las versiones afectadas están sujetas a la exfiltración arbitraria de archivos debido a un fallo en el saneo de la petición cuando son satisfechas peticiones GET para \"/images\" &amp; \"/initfilter/scripts\". Esto puede permitir a un atacante acceder a cualquier archivo en un sistema que ejecute OpenMRS que sea accesible para el ID de usuario con el que es ejecutado OpenMRS. Las implementaciones afectadas deben actualizar a la última versión del parche de OpenMRS Core para la versión menor que usan. Estas son: 2.1.5, 2.2.1, 2.3.5, 2.4.5 y 2.5.3. Como regla general, esta vulnerabilidad ya está mitigada por la normalización de URL de Tomcat en Tomcat versión 7.0.28+. Los usuarios de versiones anteriores de Tomcat deberían considerar la posibilidad de actualizar su instancia de Tomcat, así como su instancia de OpenMRS"
		}
	],
	"references": [
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Patch",
				"Third Party Advisory"
			],
			"url": "https://github.com/openmrs/openmrs-core/blob/ee3373a7a775bfdfa263e2e912c72e64342fb4f0/web/src/main/java/org/openmrs/web/filter/StartupFilter.java#L123"
		},
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Patch",
				"Third Party Advisory"
			],
			"url": "https://github.com/openmrs/openmrs-core/commit/db8454bf19a092a78d53ee4dba2af628b730a6e7#diff-7c64d9f61d4d4e2ddba92920d7cf63ec96091b308d43904956b3846bc0c26d80R128"
		},
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Exploit",
				"Patch",
				"Third Party Advisory"
			],
			"url": "https://github.com/openmrs/openmrs-core/security/advisories/GHSA-8rgr-ww69-jv65"
		},
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Patch",
				"Third Party Advisory"
			],
			"url": "https://lgtm.com/projects/g/openmrs/openmrs-core/snapshot/fb1335c925ca4c94be5a546707b90d2c1efa4dcc/files/web/src/main/java/org/openmrs/web/filter/StartupFilter.java#L123"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Patch",
				"Third Party Advisory"
			],
			"url": "https://github.com/openmrs/openmrs-core/blob/ee3373a7a775bfdfa263e2e912c72e64342fb4f0/web/src/main/java/org/openmrs/web/filter/StartupFilter.java#L123"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Patch",
				"Third Party Advisory"
			],
			"url": "https://github.com/openmrs/openmrs-core/commit/db8454bf19a092a78d53ee4dba2af628b730a6e7#diff-7c64d9f61d4d4e2ddba92920d7cf63ec96091b308d43904956b3846bc0c26d80R128"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Exploit",
				"Patch",
				"Third Party Advisory"
			],
			"url": "https://github.com/openmrs/openmrs-core/security/advisories/GHSA-8rgr-ww69-jv65"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Patch",
				"Third Party Advisory"
			],
			"url": "https://lgtm.com/projects/g/openmrs/openmrs-core/snapshot/fb1335c925ca4c94be5a546707b90d2c1efa4dcc/files/web/src/main/java/org/openmrs/web/filter/StartupFilter.java#L123"
		}
	],
	"metrics": {
		"cvssMetricV2": [
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "2.0",
					"vectorString": "AV:N/AC:L/Au:N/C:P/I:N/A:N",
					"accessVector": "NETWORK",
					"accessComplexity": "LOW",
					"authentication": "NONE",
					"confidentialityImpact": "PARTIAL",
					"integrityImpact": "NONE",
					"availabilityImpact": "NONE",
					"baseScore": 5
				},
				"baseSeverity": "MEDIUM",
				"exploitabilityScore": 10,
				"impactScore": 2.9
			}
		],
		"cvssMetricV31": [
			{
				"source": "security-advisories@github.com",
				"type": "Secondary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
					"attackVector": "NETWORK",
					"attackComplexity": "LOW",
					"privilegesRequired": "NONE",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "HIGH",
					"integrityImpact": "NONE",
					"availabilityImpact": "NONE",
					"baseScore": 7.5,
					"baseSeverity": "HIGH"
				},
				"exploitabilityScore": 3.9,
				"impactScore": 3.6
			},
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
					"attackVector": "NETWORK",
					"attackComplexity": "LOW",
					"privilegesRequired": "NONE",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "HIGH",
					"integrityImpact": "NONE",
					"availabilityImpact": "NONE",
					"baseScore": 7.5,
					"baseSeverity": "HIGH"
				},
				"exploitabilityScore": 3.9,
				"impactScore": 3.6
			}
		]
	},
	"weaknesses": [
		{
			"source": "security-advisories@github.com",
			"type": "Primary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-22"
				}
			]
		}
	],
	"configurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:openmrs:openmrs:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "CC9D911E-1D03-4348-A3E8-42EF336C3CB1",
							"versionStartIncluding": "1.6",
							"versionEndExcluding": "2.1.5"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:openmrs:openmrs:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "AB9FD95F-109C-46B6-9997-1467E85C2EA9",
							"versionStartIncluding": "2.2.0",
							"versionEndExcluding": "2.2.1"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:openmrs:openmrs:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "3CDFE507-8377-4B9E-A91E-4EAEB3893CAD",
							"versionStartIncluding": "2.3.0",
							"versionEndExcluding": "2.3.5"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:openmrs:openmrs:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "DE611740-A309-4E76-BFE2-A18978D9C50A",
							"versionStartIncluding": "2.4.0",
							"versionEndExcluding": "2.4.5"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:openmrs:openmrs:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "E69117E5-4694-44D3-8DC4-AE189857C002",
							"versionStartIncluding": "2.5.0",
							"versionEndExcluding": "2.5.3"
						}
					]
				}
			]
		}
	],
	"vcConfigurations": [
		{
			"nodes": [
				{
					"operator": "",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:openmrs:openmrs:-:*:*:*:*:*:*:*",
							"matchCriteriaId": ""
						}
					]
				}
			]
		}
	],
	"vcVulnerableCPEs": [
		"cpe:2.3:a:openmrs:openmrs:1.10.0:-:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.10.0:alpha:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.10.0:beta:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.10.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.10.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.10.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.10.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.10.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.10.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.10.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.11.0:-:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.11.0:alpha:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.11.0:beta:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.11.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.11.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.11.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.11.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.11.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.11.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.11.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.11.8:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.11.9:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.12.0:-:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.12.0:beta:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.12.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.6.0:-:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.6.0:alpha:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.6.0:beta2:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.6.0:beta3:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.6.0:beta:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.6.0:rc:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.6.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.6.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.6.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.6.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.6.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.6.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.7.0:-:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.7.0:rc2:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.7.0:rc:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.7.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.7.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.7.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.7.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.8.0:-:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.8.0:alpha:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.8.0:beta2:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.8.0:beta:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.8.0:rc:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.8.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.8.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.8.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.8.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.9.0:-:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.9.0:alpha:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.9.0:beta:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.9.0:rc2:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.9.0:rc3:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.9.0:rc4:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.9.0:rc:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.9.10:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.9.11:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.9.12:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.9.13:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.9.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.9.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.9.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.9.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.9.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.9.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.9.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.9.8:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:1.9.9:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.0.0:-:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.0.0:alpha:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.0.0:beta:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.0.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.0.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.0.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.0.4.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.0.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.0.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.0.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.0.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.0.8:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.1.0:-:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.1.0:alpha:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.1.0:beta:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.1.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.1.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.1.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.1.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.1:*:*:*:standalone:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.2.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.2.0:-:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.2.0:alpha:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.2.0:beta:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.3.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.3.0:-:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.3.0:alpha:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.3.0:beta:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.3.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.3.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.3.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.3.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.4.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.4.0:-:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.4.0:alpha2:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.4.0:alpha3:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.4.0:alpha:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.4.0:beta:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.4.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.4.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.4.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.4.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.5.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.5.0:-:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.5.0:alpha2:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.5.0:alpha3:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.5.0:alpha:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.5.0:beta2:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.5.0:beta3:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.5.0:beta4:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.5.0:beta:*:*:*:*:*:*",
		"cpe:2.3:a:openmrs:openmrs:2.5.1:*:*:*:*:*:*:*"
	]
}
