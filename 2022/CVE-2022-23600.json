{
	"id": "CVE-2022-23600",
	"sourceIdentifier": "security-advisories@github.com",
	"vulnStatus": "Modified",
	"published": "2022-02-04T23:15:15.513",
	"lastModified": "2024-11-21T06:48:54.237",
	"descriptions": [
		{
			"lang": "en",
			"value": "fleet is an open source device management, built on osquery. Versions prior to 4.9.1 expose a limited ability to spoof SAML authentication with missing audience verification. This impacts deployments using SAML SSO in two specific cases: 1. A malicious or compromised Service Provider (SP) could reuse the SAML response to log into Fleet as a user -- only if the user has an account with the same email in Fleet, _and_ the user signs into the malicious SP via SAML SSO from the same Identity Provider (IdP) configured with Fleet. 2. A user with an account in Fleet could reuse a SAML response intended for another SP to log into Fleet. This is only a concern if the user is blocked from Fleet in the IdP, but continues to have an account in Fleet. If the user is blocked from the IdP entirely, this cannot be exploited. Fleet 4.9.1 resolves this issue. Users unable to upgrade should: Reduce the length of sessions on your IdP to reduce the window for malicious re-use, Limit the amount of SAML Service Providers/Applications used by user accounts with access to Fleet, and When removing access to Fleet in the IdP, delete the Fleet user from Fleet as well."
		},
		{
			"lang": "es",
			"value": "fleet es un administrador de dispositivos de código abierto, construido sobre osquery. Las versiones anteriores a la 4.9.1 exponen una capacidad limitada para falsificar la autenticación SAML con una falta de verificación de audiencia. Esto afecta a los despliegues que usan SAML SSO en dos casos específicos: 1. Un Proveedor de Servicios (SP) malicioso o comprometido podría reusar la respuesta SAML para iniciar sesión en Fleet como un usuario - sólo si el usuario presenta una cuenta con el mismo correo electrónico en Fleet, _y_ el usuario es registrado en el SP malicioso por medio de SAML SSO desde el mismo Proveedor de Identidad (IdP) configurado con Fleet. 2. Un usuario con una cuenta en Fleet podría reusar una respuesta SAML destinada a otro SP para iniciar sesión en Fleet. Esto sólo es un problema si el usuario está bloqueado de Fleet en el IdP, pero sigue teniendo una cuenta en Fleet. Si el usuario está bloqueado en el IdP por completo, esto no puede ser explotado. Fleet versión 4.9.1 resuelve este problema. Los usuarios que no puedan actualizarse deberán: Reducir la duración de las sesiones en su IdP para reducir la ventana de reúso maliciosa, Limitar la cantidad de Proveedores de Servicios SAML/Aplicaciones usadas por las cuentas de usuario con acceso a Fleet, y Cuando elimine el acceso a Fleet en el IdP, elimine también el usuario de Fleet de Fleet"
		}
	],
	"references": [
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Patch",
				"Third Party Advisory"
			],
			"url": "https://github.com/fleetdm/fleet/commit/35d5a7b285f15ddd47486fa656e8b1acf3d48374"
		},
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Third Party Advisory"
			],
			"url": "https://github.com/fleetdm/fleet/security/advisories/GHSA-ch68-7cf4-35vr"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Patch",
				"Third Party Advisory"
			],
			"url": "https://github.com/fleetdm/fleet/commit/35d5a7b285f15ddd47486fa656e8b1acf3d48374"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Third Party Advisory"
			],
			"url": "https://github.com/fleetdm/fleet/security/advisories/GHSA-ch68-7cf4-35vr"
		}
	],
	"metrics": {
		"cvssMetricV2": [
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "2.0",
					"vectorString": "AV:N/AC:M/Au:S/C:P/I:N/A:N",
					"accessVector": "NETWORK",
					"accessComplexity": "MEDIUM",
					"authentication": "SINGLE",
					"confidentialityImpact": "PARTIAL",
					"integrityImpact": "NONE",
					"availabilityImpact": "NONE",
					"baseScore": 3.5
				},
				"baseSeverity": "LOW",
				"exploitabilityScore": 6.8,
				"impactScore": 2.9
			}
		],
		"cvssMetricV31": [
			{
				"source": "security-advisories@github.com",
				"type": "Secondary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N",
					"attackVector": "NETWORK",
					"attackComplexity": "HIGH",
					"privilegesRequired": "LOW",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "HIGH",
					"integrityImpact": "NONE",
					"availabilityImpact": "NONE",
					"baseScore": 5.3,
					"baseSeverity": "MEDIUM"
				},
				"exploitabilityScore": 1.6,
				"impactScore": 3.6
			},
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
					"attackVector": "NETWORK",
					"attackComplexity": "LOW",
					"privilegesRequired": "LOW",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "HIGH",
					"integrityImpact": "NONE",
					"availabilityImpact": "NONE",
					"baseScore": 6.5,
					"baseSeverity": "MEDIUM"
				},
				"exploitabilityScore": 2.8,
				"impactScore": 3.6
			}
		]
	},
	"weaknesses": [
		{
			"source": "security-advisories@github.com",
			"type": "Secondary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-287"
				}
			]
		},
		{
			"source": "nvd@nist.gov",
			"type": "Primary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-287"
				}
			]
		}
	],
	"configurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:fleetdm:fleet:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "15208DF4-45B8-401E-A63A-9073A80C8AF1",
							"versionEndExcluding": "4.9.1"
						}
					]
				}
			]
		}
	],
	"vcConfigurations": [
		{
			"nodes": [
				{
					"operator": "",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:fleetdm:fleet:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "",
							"versionEndExcluding": "4.9.1"
						}
					]
				}
			]
		}
	],
	"vcVulnerableCPEs": [
		"cpe:2.3:a:fleetdm:fleet:1.0.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:1.0.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:1.0.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:1.0.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:1.0.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:1.0.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:1.0.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:1.0.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:1.0.8:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:1.0.9:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:2.0.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:2.0.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:2.0.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:2.1.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:2.1.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:2.1.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:2.2.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:2.3.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:2.4.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:2.5.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:2.6.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:3.0.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:3.1.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:3.10.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:3.10.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:3.11.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:3.12.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:3.13.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:3.2.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:3.3.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:3.3.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:fleetdm:fleet:3.4.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:3.4.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:fleetdm:fleet:3.5.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:3.5.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:fleetdm:fleet:3.5.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:3.5.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:fleetdm:fleet:3.6.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:3.6.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:fleetdm:fleet:3.7.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:fleetdm:fleet:3.7.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:fleetdm:fleet:3.7.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:3.7.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:3.7.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:3.8.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:3.9.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:4.0.0:-:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:4.0.0:rc1:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:4.0.0:rc2:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:4.0.0:rc3:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:4.0.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:4.1.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:4.2.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:4.2.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:4.2.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:4.2.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:4.2.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:4.3.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:4.3.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:4.3.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:4.4.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:4.4.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:4.4.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:4.4.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:4.5.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:4.5.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:4.6.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:4.6.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:4.6.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:4.7.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:4.8.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:fleetdm:fleet:4.9.0:*:*:*:*:*:*:*"
	]
}
