{
	"id": "CVE-2020-28494",
	"sourceIdentifier": "report@snyk.io",
	"vulnStatus": "Modified",
	"published": "2021-02-02T11:15:13.067",
	"lastModified": "2024-11-21T05:22:54.163",
	"descriptions": [
		{
			"lang": "en",
			"value": "This affects the package total.js before 3.4.7. The issue occurs in the image.pipe and image.stream functions. The type parameter is used to build the command that is then executed using child_process.spawn. The issue occurs because child_process.spawn is called with the option shell set to true and because the type parameter is not properly sanitized."
		},
		{
			"lang": "es",
			"value": "Esto afecta al paquete total.js versiones anteriores a 3.4.7.&#xa0;El problema ocurre en las funciones image.pipe e image.stream.&#xa0;El par치metro type es usado para construir el comando que luego es ejecutado usando child_process.spawn.&#xa0;El problema ocurre porque child_process.spawn es llamado con la opci칩n shell ajustada en true y porque el par치metro type no est치 apropiadamente saneado"
		}
	],
	"references": [
		{
			"source": "report@snyk.io",
			"tags": [
				"Patch",
				"Third Party Advisory"
			],
			"url": "https://github.com/totaljs/framework/commit/6192491ab2631e7c1d317c221f18ea613e2c18a5"
		},
		{
			"source": "report@snyk.io",
			"tags": [
				"Exploit",
				"Patch",
				"Third Party Advisory"
			],
			"url": "https://snyk.io/vuln/SNYK-JS-TOTALJS-1046672"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Patch",
				"Third Party Advisory"
			],
			"url": "https://github.com/totaljs/framework/commit/6192491ab2631e7c1d317c221f18ea613e2c18a5"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Exploit",
				"Patch",
				"Third Party Advisory"
			],
			"url": "https://snyk.io/vuln/SNYK-JS-TOTALJS-1046672"
		}
	],
	"metrics": {
		"cvssMetricV2": [
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "2.0",
					"vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
					"accessVector": "NETWORK",
					"accessComplexity": "LOW",
					"authentication": "NONE",
					"confidentialityImpact": "PARTIAL",
					"integrityImpact": "PARTIAL",
					"availabilityImpact": "PARTIAL",
					"baseScore": 7.5
				},
				"baseSeverity": "HIGH",
				"exploitabilityScore": 10,
				"impactScore": 6.4
			}
		],
		"cvssMetricV31": [
			{
				"source": "report@snyk.io",
				"type": "Secondary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:L",
					"attackVector": "NETWORK",
					"attackComplexity": "LOW",
					"privilegesRequired": "NONE",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "HIGH",
					"integrityImpact": "LOW",
					"availabilityImpact": "LOW",
					"baseScore": 8.6,
					"baseSeverity": "HIGH"
				},
				"exploitabilityScore": 3.9,
				"impactScore": 4.7
			}
		]
	},
	"weaknesses": [
		{
			"source": "nvd@nist.gov",
			"type": "Primary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-78"
				}
			]
		}
	],
	"configurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:totaljs:total.js:*:*:*:*:*:node.js:*:*",
							"matchCriteriaId": "09C704BC-AD46-464A-B3CD-D2D54FF353BA",
							"versionEndExcluding": "3.4.7"
						}
					]
				}
			]
		}
	],
	"vcConfigurations": [
		{
			"nodes": [
				{
					"operator": "",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:totaljs:total.js:*:*:*:*:*:node.js:*:*",
							"matchCriteriaId": "",
							"versionEndExcluding": "3.4.7"
						}
					]
				}
			]
		}
	],
	"vcVulnerableCPEs": [
		"cpe:2.3:a:totaljs:total.js:1.0.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:1.0.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:1.0.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:1.1.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:1.2.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:1.2.3-1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:1.2.3:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:1.2.4:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:1.3.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:1.3.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:1.4.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:1.5.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:1.5.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:1.5.3:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:1.6.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:1.6.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:1.6.3:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:1.7.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:1.7.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:1.7.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:1.8.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:1.9.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:1.9.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:1.9.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:1.9.3:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:1.9.4:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:1.9.5:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:1.9.6:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:1.9.7:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:1.9.8:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:2.0.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:2.0.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:2.1.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:2.2.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:2.3.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:2.4.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:2.5.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:2.6.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:2.6.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:2.6.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:2.7.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:2.8.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:2.9.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:2.9.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:2.9.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:2.9.3:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:2.9.4:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:3.0.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:3.1.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:3.2.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:3.3.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:3.3.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:3.3.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:3.4.0:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:3.4.1:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:3.4.2:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:3.4.3:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:3.4.4:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:3.4.5:*:*:*:*:node.js:*:*",
		"cpe:2.3:a:totaljs:total.js:3.4.6:*:*:*:*:node.js:*:*"
	]
}
