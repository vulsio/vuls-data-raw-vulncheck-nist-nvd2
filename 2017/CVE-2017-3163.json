{
	"id": "CVE-2017-3163",
	"sourceIdentifier": "security@apache.org",
	"vulnStatus": "Deferred",
	"published": "2017-08-30T14:29:00.207",
	"lastModified": "2025-04-20T01:37:25.860",
	"descriptions": [
		{
			"lang": "en",
			"value": "When using the Index Replication feature, Apache Solr nodes can pull index files from a master/leader node using an HTTP API which accepts a file name. However, Solr before 5.5.4 and 6.x before 6.4.1 did not validate the file name, hence it was possible to craft a special request involving path traversal, leaving any file readable to the Solr server process exposed. Solr servers protected and restricted by firewall rules and/or authentication would not be at risk since only trusted clients and users would gain direct HTTP access."
		},
		{
			"lang": "es",
			"value": "Cuando se usa la característica Index Replication, los nodos Apache Solr pueden tomar archivos index de un nodo master/leader usando una API HTTP que acepta un nombre de archivo. Sin embargo, Solr en versiones anteriores a la 5.5.4 y en versiones 6.x anteriores a la 6.4.1 no valida el nombre de archivo, por lo que fue posible manipular una petición especial que involucre un salto de ruta, dejando expuestos todos los archivos legibles en el proceso de servidor Solr. Los servidores Solr protegidos y restringidos por reglas de firewall y/o autenticación no estarían en riesgo ya que solo los clientes y usuarios de confianza obtendrían acceso HTTP directo."
		}
	],
	"references": [
		{
			"source": "security@apache.org",
			"url": "https://access.redhat.com/errata/RHSA-2018:1447"
		},
		{
			"source": "security@apache.org",
			"url": "https://access.redhat.com/errata/RHSA-2018:1448"
		},
		{
			"source": "security@apache.org",
			"url": "https://access.redhat.com/errata/RHSA-2018:1449"
		},
		{
			"source": "security@apache.org",
			"url": "https://access.redhat.com/errata/RHSA-2018:1450"
		},
		{
			"source": "security@apache.org",
			"url": "https://access.redhat.com/errata/RHSA-2018:1451"
		},
		{
			"source": "security@apache.org",
			"url": "https://lists.apache.org/thread.html/a6a33a186f293f9f9aecf3bd39c76252bfc49a79de4321dd2a53b488%40%3Csolr-user.lucene.apache.org%3E"
		},
		{
			"source": "security@apache.org",
			"url": "https://www.debian.org/security/2018/dsa-4124"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"url": "https://access.redhat.com/errata/RHSA-2018:1447"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"url": "https://access.redhat.com/errata/RHSA-2018:1448"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"url": "https://access.redhat.com/errata/RHSA-2018:1449"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"url": "https://access.redhat.com/errata/RHSA-2018:1450"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"url": "https://access.redhat.com/errata/RHSA-2018:1451"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"url": "https://lists.apache.org/thread.html/a6a33a186f293f9f9aecf3bd39c76252bfc49a79de4321dd2a53b488%40%3Csolr-user.lucene.apache.org%3E"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"url": "https://www.debian.org/security/2018/dsa-4124"
		}
	],
	"metrics": {
		"cvssMetricV2": [
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "2.0",
					"vectorString": "AV:N/AC:L/Au:N/C:P/I:N/A:N",
					"accessVector": "NETWORK",
					"accessComplexity": "LOW",
					"authentication": "NONE",
					"confidentialityImpact": "PARTIAL",
					"integrityImpact": "NONE",
					"availabilityImpact": "NONE",
					"baseScore": 5
				},
				"baseSeverity": "MEDIUM",
				"exploitabilityScore": 10,
				"impactScore": 2.9
			}
		],
		"cvssMetricV30": [
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "3.0",
					"vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
					"attackVector": "NETWORK",
					"attackComplexity": "LOW",
					"privilegesRequired": "NONE",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "HIGH",
					"integrityImpact": "NONE",
					"availabilityImpact": "NONE",
					"baseScore": 7.5,
					"baseSeverity": "HIGH",
					"temporalScore": 0,
					"environmentalScore": 0
				},
				"exploitabilityScore": 3.9,
				"impactScore": 3.6
			}
		]
	},
	"weaknesses": [
		{
			"source": "nvd@nist.gov",
			"type": "Primary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-22"
				}
			]
		}
	],
	"configurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:apache:solr:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "C0CB118A-E405-41E5-B25F-C151B14292A7",
							"versionEndIncluding": "5.5.3"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:apache:solr:6.0.0:*:*:*:*:*:*:*",
							"matchCriteriaId": "29F3170C-C5D6-431F-A2DD-692636CF5DAB"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:apache:solr:6.0.1:*:*:*:*:*:*:*",
							"matchCriteriaId": "BA339070-A2BD-4559-B400-2BC2EB9923A7"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:apache:solr:6.1.0:*:*:*:*:*:*:*",
							"matchCriteriaId": "B737CF14-C14A-4D97-B838-47EC4A2C68C8"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:apache:solr:6.2.0:*:*:*:*:*:*:*",
							"matchCriteriaId": "036F935D-B469-47C6-AF5D-3DFC73070753"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:apache:solr:6.2.1:*:*:*:*:*:*:*",
							"matchCriteriaId": "42A1A17A-32EA-40A2-9A1E-6019B493B5C1"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:apache:solr:6.3.0:*:*:*:*:*:*:*",
							"matchCriteriaId": "76557E9C-1F16-44D9-ACA1-F4DAEC966F05"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:apache:solr:6.4.0:*:*:*:*:*:*:*",
							"matchCriteriaId": "DE068A02-D47A-4C6C-BFD3-040385599CA5"
						}
					]
				}
			]
		}
	],
	"vcConfigurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:apache:solr:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "",
							"versionStartIncluding": "1.4.0",
							"versionEndIncluding": "5.5.3"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:apache:solr:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "",
							"versionStartIncluding": "6.0.0",
							"versionEndIncluding": "6.4.0"
						}
					]
				}
			]
		}
	],
	"vcVulnerableCPEs": [
		"cpe:2.3:a:apache:solr:1.4.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:1.4.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:3.1.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:3.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:3.2.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:3.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:3.3.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:3.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:3.4.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:3.5.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:3.6.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:3.6.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:3.6.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:4.0.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:4.0.0:-:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:4.0.0:alpha:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:4.0.0:beta:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:4.1.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:4.10.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:4.10.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:4.10.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:4.10.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:4.10.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:4.2.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:4.2.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:4.3.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:4.3.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:4.4.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:4.5.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:4.5.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:4.6.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:4.6.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:4.7.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:4.7.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:4.7.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:4.8.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:4.8.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:4.9.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:4.9.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:5.0.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:5.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:5.1.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:5.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:5.2.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:5.2.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:5.3.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:5.3.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:5.3.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:5.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:5.4.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:5.4.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:5.5.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:5.5.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:5.5.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:5.5.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:6.0.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:6.0.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:6.1.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:6.2.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:6.2.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:6.3.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:apache:solr:6.4.0:*:*:*:*:*:*:*"
	]
}
