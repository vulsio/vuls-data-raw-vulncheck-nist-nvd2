{
	"id": "CVE-2017-15806",
	"sourceIdentifier": "cve@mitre.org",
	"vulnStatus": "Deferred",
	"published": "2017-11-15T16:29:00.483",
	"lastModified": "2025-04-20T01:37:25.860",
	"descriptions": [
		{
			"lang": "en",
			"value": "The send function in the ezcMailMtaTransport class in Zeta Components Mail before 1.8.2 does not properly restrict the set of characters used in the ezcMail returnPath property, which might allow remote attackers to execute arbitrary code via a crafted email address, as demonstrated by one containing \"-X/path/to/wwwroot/file.php.\""
		},
		{
			"lang": "es",
			"value": "La función send en la clase ezcMailMtaTransport en Zeta Components Mail en versiones anteriores a la 1.8.2 no restringe correctamente el conjunto de caracteres empleados en la propiedad de ezcMail returnPath, lo que podría permitir que atacantes remotos ejecuten código arbitrario mediante una dirección de correo electrónico manipulada, tal y como demuestra una que contenga \"-X/path/to/wwwroot/file.php\"."
		}
	],
	"references": [
		{
			"source": "cve@mitre.org",
			"tags": [
				"Third Party Advisory",
				"VDB Entry"
			],
			"url": "http://www.securityfocus.com/bid/101866"
		},
		{
			"source": "cve@mitre.org",
			"tags": [
				"Issue Tracking",
				"Third Party Advisory"
			],
			"url": "https://github.com/zetacomponents/Mail/issues/58"
		},
		{
			"source": "cve@mitre.org",
			"tags": [
				"Issue Tracking",
				"Release Notes",
				"Third Party Advisory"
			],
			"url": "https://github.com/zetacomponents/Mail/releases/tag/1.8.2"
		},
		{
			"source": "cve@mitre.org",
			"tags": [
				"Issue Tracking",
				"Third Party Advisory"
			],
			"url": "https://kay-malwarebenchmark.github.io/blog/cve-2017-15806-critical-rce-vulnerability/"
		},
		{
			"source": "cve@mitre.org",
			"tags": [
				"Issue Tracking",
				"Third Party Advisory"
			],
			"url": "https://kay-malwarebenchmark.github.io/blog/cve-2017-15806-yuan-cheng-dai-ma-zhi-xing-lou-dong/"
		},
		{
			"source": "cve@mitre.org",
			"tags": [
				"Issue Tracking",
				"Third Party Advisory",
				"VDB Entry",
				"Exploit"
			],
			"url": "https://www.exploit-db.com/exploits/43155/"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Third Party Advisory",
				"VDB Entry"
			],
			"url": "http://www.securityfocus.com/bid/101866"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Issue Tracking",
				"Third Party Advisory"
			],
			"url": "https://github.com/zetacomponents/Mail/issues/58"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Issue Tracking",
				"Release Notes",
				"Third Party Advisory"
			],
			"url": "https://github.com/zetacomponents/Mail/releases/tag/1.8.2"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Issue Tracking",
				"Third Party Advisory"
			],
			"url": "https://kay-malwarebenchmark.github.io/blog/cve-2017-15806-critical-rce-vulnerability/"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Issue Tracking",
				"Third Party Advisory"
			],
			"url": "https://kay-malwarebenchmark.github.io/blog/cve-2017-15806-yuan-cheng-dai-ma-zhi-xing-lou-dong/"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Issue Tracking",
				"Third Party Advisory",
				"VDB Entry",
				"Exploit"
			],
			"url": "https://www.exploit-db.com/exploits/43155/"
		}
	],
	"metrics": {
		"cvssMetricV2": [
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "2.0",
					"vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P",
					"accessVector": "NETWORK",
					"accessComplexity": "MEDIUM",
					"authentication": "NONE",
					"confidentialityImpact": "PARTIAL",
					"integrityImpact": "PARTIAL",
					"availabilityImpact": "PARTIAL",
					"baseScore": 6.8
				},
				"baseSeverity": "MEDIUM",
				"exploitabilityScore": 8.6,
				"impactScore": 6.4
			}
		],
		"cvssMetricV30": [
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "3.0",
					"vectorString": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
					"attackVector": "NETWORK",
					"attackComplexity": "HIGH",
					"privilegesRequired": "NONE",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "HIGH",
					"integrityImpact": "HIGH",
					"availabilityImpact": "HIGH",
					"baseScore": 8.1,
					"baseSeverity": "HIGH",
					"temporalScore": 0,
					"environmentalScore": 0
				},
				"exploitabilityScore": 2.2,
				"impactScore": 5.9
			}
		]
	},
	"weaknesses": [
		{
			"source": "nvd@nist.gov",
			"type": "Primary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-94"
				}
			]
		}
	],
	"configurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:zetacomponents:mail:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "927EE589-CA16-4708-B79F-DD7881B590F6",
							"versionEndExcluding": "1.8.2"
						}
					]
				}
			]
		}
	],
	"vcConfigurations": [
		{
			"nodes": [
				{
					"operator": "",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:zetacomponents:mail:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "",
							"versionEndExcluding": "1.8.2"
						}
					]
				}
			]
		}
	],
	"vcVulnerableCPEs": [
		"cpe:2.3:a:zetacomponents:mail:1.1.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.1.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.1:-:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.1:alpha1:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.1:beta1:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.1:beta2:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.1:rc1:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.2:-:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.2:beta1:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.2:beta2:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.3:-:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.3:beta2:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.3:rc1:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.4.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.4.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.4.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.4:-:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.4:alpha1:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.4:alpha2:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.4:beta1:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.4:rc1:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.5.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.5.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.5:-:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.5:alpha1:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.5:beta1:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.5:rc1:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.6.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.6.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.6.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.6:-:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.6:alpha1:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.6:beta1:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.6:rc:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.7:-:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.7:alpha1:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.7:beta1:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.7:rc1:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.8.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.8:-:*:*:*:*:*:*",
		"cpe:2.3:a:zetacomponents:mail:1.8:beta1:*:*:*:*:*:*"
	]
}
