{
	"id": "CVE-2021-21246",
	"sourceIdentifier": "security-advisories@github.com",
	"vulnStatus": "Modified",
	"published": "2021-01-15T21:15:13.490",
	"lastModified": "2024-11-21T05:47:51.363",
	"descriptions": [
		{
			"lang": "en",
			"value": "OneDev is an all-in-one devops platform. In OneDev before version 4.0.3, the REST UserResource endpoint performs a security check to make sure that only administrators can list user details. However for the `/users/{id}` endpoint there are no security checks enforced so it is possible to retrieve arbitrary user details including their Access Tokens! These access tokens can be used to access the API or clone code in the build spec via the HTTP(S) protocol. It has permissions to all projects accessible by the user account. This issue may lead to `Sensitive data leak` and leak the Access Token which can be used to impersonate the administrator or any other users. This issue was addressed in 4.0.3 by removing user info from restful api."
		},
		{
			"lang": "es",
			"value": "OneDev es una plataforma devops todo en uno.&#xa0;En OneDev versiones anteriores a  4.0.3, el endpoint de REST UserResource lleva a cabo una comprobación de seguridad para asegurarse de que solo los administradores puedan enumerar los detalles del usuario.&#xa0;Sin embargo, para el endpoint \"/users/{id}\" no son aplicados controles de seguridad, por lo que es posible recuperar detalles arbitrarios del usuario, incluyendo sus tokens de acceso.&#xa0;Estos tokens de acceso pueden ser usados para acceder a la API o al código de clonación en la especificación de compilación por medio del protocolo HTTP(S).&#xa0;Presenta permisos para todos los proyectos accesibles por la cuenta de usuario.&#xa0;Este problema puede conllevar a una \"filtración de datos confidenciales\" y el token de acceso, que puede ser usada para hacerse pasar por el administrador o cualquier otro usuario.&#xa0;Este problema fue abordado en la versión 4.0.3 al eliminar la información del usuario de la API restful"
		}
	],
	"references": [
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Patch",
				"Third Party Advisory"
			],
			"url": "https://github.com/theonedev/onedev/commit/a4491e5f79dc6cc96eac20972eedc8905ddf6089"
		},
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Third Party Advisory"
			],
			"url": "https://github.com/theonedev/onedev/security/advisories/GHSA-66v7-gg85-f4gx"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Patch",
				"Third Party Advisory"
			],
			"url": "https://github.com/theonedev/onedev/commit/a4491e5f79dc6cc96eac20972eedc8905ddf6089"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Third Party Advisory"
			],
			"url": "https://github.com/theonedev/onedev/security/advisories/GHSA-66v7-gg85-f4gx"
		}
	],
	"metrics": {
		"cvssMetricV2": [
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "2.0",
					"vectorString": "AV:N/AC:L/Au:N/C:P/I:N/A:N",
					"accessVector": "NETWORK",
					"accessComplexity": "LOW",
					"authentication": "NONE",
					"confidentialityImpact": "PARTIAL",
					"integrityImpact": "NONE",
					"availabilityImpact": "NONE",
					"baseScore": 5
				},
				"baseSeverity": "MEDIUM",
				"exploitabilityScore": 10,
				"impactScore": 2.9
			}
		],
		"cvssMetricV31": [
			{
				"source": "security-advisories@github.com",
				"type": "Secondary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N",
					"attackVector": "NETWORK",
					"attackComplexity": "LOW",
					"privilegesRequired": "NONE",
					"userInteraction": "NONE",
					"scope": "CHANGED",
					"confidentialityImpact": "HIGH",
					"integrityImpact": "NONE",
					"availabilityImpact": "NONE",
					"baseScore": 8.6,
					"baseSeverity": "HIGH"
				},
				"exploitabilityScore": 3.9,
				"impactScore": 4
			},
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
					"attackVector": "NETWORK",
					"attackComplexity": "LOW",
					"privilegesRequired": "NONE",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "HIGH",
					"integrityImpact": "NONE",
					"availabilityImpact": "NONE",
					"baseScore": 7.5,
					"baseSeverity": "HIGH"
				},
				"exploitabilityScore": 3.9,
				"impactScore": 3.6
			}
		]
	},
	"weaknesses": [
		{
			"source": "security-advisories@github.com",
			"type": "Primary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-862"
				}
			]
		}
	],
	"configurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:onedev_project:onedev:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "5287F01C-3A77-4491-AB49-401A50FAA6E9",
							"versionEndExcluding": "4.0.3"
						}
					]
				}
			]
		}
	],
	"vcConfigurations": [
		{
			"nodes": [
				{
					"operator": "",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:onedev_project:onedev:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "",
							"versionEndExcluding": "4.0.2"
						}
					]
				}
			]
		}
	],
	"vcVulnerableCPEs": [
		"cpe:2.3:a:onedev_project:onedev:2.0.0:-:*:*:*:*:*:*",
		"cpe:2.3:a:onedev_project:onedev:2.0.0:beta_build118:*:*:*:*:*:*",
		"cpe:2.3:a:onedev_project:onedev:2.0.0:beta_build119:*:*:*:*:*:*",
		"cpe:2.3:a:onedev_project:onedev:2.0.0:beta_build120:*:*:*:*:*:*",
		"cpe:2.3:a:onedev_project:onedev:2.0.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:onedev_project:onedev:2.0.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:onedev_project:onedev:2.0.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:onedev_project:onedev:2.0.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:onedev_project:onedev:2.0.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:onedev_project:onedev:2.0.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:onedev_project:onedev:2.0.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:onedev_project:onedev:2.0.8:*:*:*:*:*:*:*",
		"cpe:2.3:a:onedev_project:onedev:3.0.10:*:*:*:*:*:*:*",
		"cpe:2.3:a:onedev_project:onedev:3.0.11:*:*:*:*:*:*:*",
		"cpe:2.3:a:onedev_project:onedev:3.0.12:*:*:*:*:*:*:*",
		"cpe:2.3:a:onedev_project:onedev:3.0.13:*:*:*:*:*:*:*",
		"cpe:2.3:a:onedev_project:onedev:3.0.14:*:*:*:*:*:*:*",
		"cpe:2.3:a:onedev_project:onedev:3.0.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:onedev_project:onedev:3.0.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:onedev_project:onedev:3.0.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:onedev_project:onedev:3.0.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:onedev_project:onedev:3.0.8:*:*:*:*:*:*:*",
		"cpe:2.3:a:onedev_project:onedev:3.0.9:*:*:*:*:*:*:*",
		"cpe:2.3:a:onedev_project:onedev:3.1.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:onedev_project:onedev:3.1.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:onedev_project:onedev:3.1.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:onedev_project:onedev:3.2.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:onedev_project:onedev:3.2.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:onedev_project:onedev:3.2.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:onedev_project:onedev:3.2.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:onedev_project:onedev:3.2.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:onedev_project:onedev:3.2.5:*:*:*:*:*:*:*",
		"cpe:2.3:a:onedev_project:onedev:3.2.6:*:*:*:*:*:*:*",
		"cpe:2.3:a:onedev_project:onedev:3.2.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:onedev_project:onedev:3.2.8:*:*:*:*:*:*:*",
		"cpe:2.3:a:onedev_project:onedev:3.2.9:*:*:*:*:*:*:*",
		"cpe:2.3:a:onedev_project:onedev:4.0.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:onedev_project:onedev:4.0.1:*:*:*:*:*:*:*"
	]
}
