{
	"id": "CVE-2021-47493",
	"sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
	"vulnStatus": "Awaiting Analysis",
	"published": "2024-05-22T09:15:11.100",
	"lastModified": "2024-11-21T06:36:19.610",
	"descriptions": [
		{
			"lang": "en",
			"value": "In the Linux kernel, the following vulnerability has been resolved:\n\nocfs2: fix race between searching chunks and release journal_head from buffer_head\n\nEncountered a race between ocfs2_test_bg_bit_allocatable() and\njbd2_journal_put_journal_head() resulting in the below vmcore.\n\n  PID: 106879  TASK: ffff880244ba9c00  CPU: 2   COMMAND: \"loop3\"\n  Call trace:\n    panic\n    oops_end\n    no_context\n    __bad_area_nosemaphore\n    bad_area_nosemaphore\n    __do_page_fault\n    do_page_fault\n    page_fault\n      [exception RIP: ocfs2_block_group_find_clear_bits+316]\n    ocfs2_block_group_find_clear_bits [ocfs2]\n    ocfs2_cluster_group_search [ocfs2]\n    ocfs2_search_chain [ocfs2]\n    ocfs2_claim_suballoc_bits [ocfs2]\n    __ocfs2_claim_clusters [ocfs2]\n    ocfs2_claim_clusters [ocfs2]\n    ocfs2_local_alloc_slide_window [ocfs2]\n    ocfs2_reserve_local_alloc_bits [ocfs2]\n    ocfs2_reserve_clusters_with_limit [ocfs2]\n    ocfs2_reserve_clusters [ocfs2]\n    ocfs2_lock_refcount_allocators [ocfs2]\n    ocfs2_make_clusters_writable [ocfs2]\n    ocfs2_replace_cow [ocfs2]\n    ocfs2_refcount_cow [ocfs2]\n    ocfs2_file_write_iter [ocfs2]\n    lo_rw_aio\n    loop_queue_work\n    kthread_worker_fn\n    kthread\n    ret_from_fork\n\nWhen ocfs2_test_bg_bit_allocatable() called bh2jh(bg_bh), the\nbg_bh->b_private NULL as jbd2_journal_put_journal_head() raced and\nreleased the jounal head from the buffer head.  Needed to take bit lock\nfor the bit 'BH_JournalHead' to fix this race."
		},
		{
			"lang": "es",
			"value": "En el kernel de Linux, se resolvió la siguiente vulnerabilidad: ocfs2: corrige la ejecución entre fragmentos de búsqueda y libera journal_head de buffer_head Se encontró una ejecución entre ocfs2_test_bg_bit_allocatable() y jbd2_journal_put_journal_head() que resultó en el siguiente vmcore. PID: 106879 TAREA: ffff880244ba9c00 CPU: 2 COMANDO: \"loop3\" Rastreo de llamadas: pánico oops_end no_context __bad_area_nosemaphore bad_area_nosemaphore __do_page_fault do_page_fault page_fault [excepción RIP: ocfs2_block_group_find_clear_bits+316] 2_block_group_find_clear_bits [ocfs2] ocfs2_cluster_group_search [ocfs2] ocfs2_search_chain [ocfs2] ocfs2_claim_suballoc_bits [ocfs2] __ocfs2_claim_clusters [ocfs2] ocfs2_claim_clusters [ocfs2] ocfs2_local_alloc_slide_window [ocfs2] ocfs2_reserve_local_alloc_bits [ocfs2] ocfs2_reserve_clusters_with_limit [ocfs2] ocfs2_reserve_clusters [ocfs2] ocfs2_lock_refcount_allocators [ocfs2] 2_make_clusters_writable [ocfs2] ocfs2_replace_cow [ocfs2] ocfs2_refcount_cow [ocfs2] ocfs2_file_write_iter [ocfs2] lo_rw_aio loop_queue_work kthread_worker_fn kthread ret_from_fork Cuando ocfs2_test_bg_bit_allocatable () llamado bh2jh(bg_bh), el bg_bh-&gt;b_private NULL como jbd2_journal_put_journal_head() corrió y liberó el encabezado del diario del encabezado del búfer. Era necesario bloquear el bit 'BH_JournalHead' para solucionar esta ejecución."
		}
	],
	"references": [
		{
			"source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
			"url": "https://git.kernel.org/stable/c/2e382600e8856ea654677b5134ee66e03ea72bc2"
		},
		{
			"source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
			"url": "https://git.kernel.org/stable/c/5043fbd294f5909a080ade0f04b70a4da9e122b7"
		},
		{
			"source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
			"url": "https://git.kernel.org/stable/c/6f1b228529ae49b0f85ab89bcdb6c365df401558"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"url": "https://git.kernel.org/stable/c/2e382600e8856ea654677b5134ee66e03ea72bc2"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"url": "https://git.kernel.org/stable/c/5043fbd294f5909a080ade0f04b70a4da9e122b7"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"url": "https://git.kernel.org/stable/c/6f1b228529ae49b0f85ab89bcdb6c365df401558"
		}
	],
	"metrics": {},
	"vcConfigurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "",
							"versionStartIncluding": "5.10",
							"versionEndExcluding": "5.10.77"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "",
							"versionStartIncluding": "5.14",
							"versionEndExcluding": "5.14.16"
						}
					]
				}
			]
		}
	],
	"vcVulnerableCPEs": [
		"cpe:2.3:o:linux:linux_kernel:5.10.0:-:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.0:rc1:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.0:rc2:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.0:rc3:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.0:rc4:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.0:rc5:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.10:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.11:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.12:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.13:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.14:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.15:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.16:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.17:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.18:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.19:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.1:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.20:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.21:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.22:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.23:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.24:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.25:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.26:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.27:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.28:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.29:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.2:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.30:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.31:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.32:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.33:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.34:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.35:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.36:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.37:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.38:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.39:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.3:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.40:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.41:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.42:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.43:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.44:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.45:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.46:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.47:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.48:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.49:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.4:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.50:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.51:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.52:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.53:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.54:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.55:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.56:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.57:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.58:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.59:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.5:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.60:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.61:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.62:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.63:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.64:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.65:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.66:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.67:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.68:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.69:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.6:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.70:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.71:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.72:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.73:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.74:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.75:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.76:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.7:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.8:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10.9:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10:-:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10:rc1:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10:rc2:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.10:rc4:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.14.0-49.el9:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.14.10:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.14.11:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.14.12:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.14.13:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.14.14:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.14.15:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.14.1:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.14.2:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.14.3:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.14.4:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.14.5:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.14.6:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.14.7:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.14.8:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.14.9:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.14:*:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.14:-:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.14:rc1:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.14:rc2:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.14:rc3:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.14:rc4:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.14:rc5:*:*:*:*:*:*",
		"cpe:2.3:o:linux:linux_kernel:5.14:rc6:*:*:*:*:*:*"
	]
}
