{
	"id": "CVE-2021-42392",
	"sourceIdentifier": "reefs@jfrog.com",
	"vulnStatus": "Modified",
	"published": "2022-01-10T14:10:23.643",
	"lastModified": "2024-11-21T06:27:43.510",
	"descriptions": [
		{
			"lang": "en",
			"value": "The org.h2.util.JdbcUtils.getConnection method of the H2 database takes as parameters the class name of the driver and URL of the database. An attacker may pass a JNDI driver name and a URL leading to a LDAP or RMI servers, causing remote code execution. This can be exploited through various attack vectors, most notably through the H2 Console which leads to unauthenticated remote code execution."
		},
		{
			"lang": "es",
			"value": "El método org.h2.util.JdbcUtils.getConnection de la base de datos H2 toma como parámetros el nombre de la clase del controlador y la URL de la base de datos. Un atacante puede pasar un nombre de controlador JNDI y una URL que conlleve a un servidor LDAP o RMI, causando una ejecución de código remota. Esto puede ser explotado mediante varios vectores de ataque, sobre todo mediante la Consola H2 que conlleva a una ejecución de código remoto no autenticado"
		}
	],
	"references": [
		{
			"source": "reefs@jfrog.com",
			"tags": [
				"Mitigation",
				"Third Party Advisory"
			],
			"url": "https://github.com/h2database/h2database/security/advisories/GHSA-h376-j262-vhq6"
		},
		{
			"source": "reefs@jfrog.com",
			"tags": [
				"Exploit",
				"Technical Description",
				"Vendor Advisory"
			],
			"url": "https://jfrog.com/blog/the-jndi-strikes-back-unauthenticated-rce-in-h2-database-console/"
		},
		{
			"source": "reefs@jfrog.com",
			"tags": [
				"Mailing List",
				"Third Party Advisory"
			],
			"url": "https://lists.debian.org/debian-lts-announce/2022/02/msg00017.html"
		},
		{
			"source": "reefs@jfrog.com",
			"tags": [
				"Third Party Advisory"
			],
			"url": "https://security.netapp.com/advisory/ntap-20220119-0001/"
		},
		{
			"source": "reefs@jfrog.com",
			"tags": [
				"Third Party Advisory"
			],
			"url": "https://www.debian.org/security/2022/dsa-5076"
		},
		{
			"source": "reefs@jfrog.com",
			"tags": [
				"Patch",
				"Third Party Advisory"
			],
			"url": "https://www.oracle.com/security-alerts/cpuapr2022.html"
		},
		{
			"source": "reefs@jfrog.com",
			"url": "https://www.secpod.com/blog/log4shell-critical-remote-code-execution-vulnerability-in-h2database-console/"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Mitigation",
				"Third Party Advisory"
			],
			"url": "https://github.com/h2database/h2database/security/advisories/GHSA-h376-j262-vhq6"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Exploit",
				"Technical Description",
				"Vendor Advisory"
			],
			"url": "https://jfrog.com/blog/the-jndi-strikes-back-unauthenticated-rce-in-h2-database-console/"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Mailing List",
				"Third Party Advisory"
			],
			"url": "https://lists.debian.org/debian-lts-announce/2022/02/msg00017.html"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Third Party Advisory"
			],
			"url": "https://security.netapp.com/advisory/ntap-20220119-0001/"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Third Party Advisory"
			],
			"url": "https://www.debian.org/security/2022/dsa-5076"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Patch",
				"Third Party Advisory"
			],
			"url": "https://www.oracle.com/security-alerts/cpuapr2022.html"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"url": "https://www.secpod.com/blog/log4shell-critical-remote-code-execution-vulnerability-in-h2database-console/"
		}
	],
	"metrics": {
		"cvssMetricV2": [
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "2.0",
					"vectorString": "AV:N/AC:L/Au:N/C:C/I:C/A:C",
					"accessVector": "NETWORK",
					"accessComplexity": "LOW",
					"authentication": "NONE",
					"confidentialityImpact": "COMPLETE",
					"integrityImpact": "COMPLETE",
					"availabilityImpact": "COMPLETE",
					"baseScore": 10
				},
				"baseSeverity": "HIGH",
				"exploitabilityScore": 10,
				"impactScore": 10
			}
		],
		"cvssMetricV31": [
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
					"attackVector": "NETWORK",
					"attackComplexity": "LOW",
					"privilegesRequired": "NONE",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "HIGH",
					"integrityImpact": "HIGH",
					"availabilityImpact": "HIGH",
					"baseScore": 9.8,
					"baseSeverity": "CRITICAL"
				},
				"exploitabilityScore": 3.9,
				"impactScore": 5.9
			}
		]
	},
	"weaknesses": [
		{
			"source": "reefs@jfrog.com",
			"type": "Secondary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-502"
				}
			]
		},
		{
			"source": "nvd@nist.gov",
			"type": "Primary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-502"
				}
			]
		}
	],
	"configurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:h2database:h2:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "6770600B-79F8-4C9A-A455-CC0F0604D864",
							"versionStartIncluding": "1.1.000",
							"versionEndIncluding": "2.0.204"
						}
					]
				}
			]
		},
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*",
							"matchCriteriaId": "DEECE5FC-CACF-4496-A3E7-164736409252"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*",
							"matchCriteriaId": "07B237A9-69A3-4A9C-9DA0-4E06BD37AE73"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*",
							"matchCriteriaId": "FA6FEEC2-9F11-4643-8827-749718254FED"
						}
					]
				}
			]
		},
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:oracle:communications_cloud_native_core_policy:1.15.0:*:*:*:*:*:*:*",
							"matchCriteriaId": "B4367D9B-BF81-47AD-A840-AC46317C774D"
						}
					]
				}
			]
		}
	],
	"vcConfigurations": [
		{
			"nodes": [
				{
					"operator": "",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:h2database:h2:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "",
							"versionStartIncluding": "1.1.100",
							"versionEndExcluding": "2.0.206"
						}
					]
				}
			]
		}
	],
	"vcVulnerableCPEs": [
		"cpe:2.3:a:h2database:h2:1.1.100:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.1.101:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.1.102:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.1.103:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.1.104:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.1.105:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.1.106:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.1.107:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.1.108:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.1.109:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.1.110:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.1.111:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.1.112:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.1.113:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.1.114:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.1.115:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.1.116:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.1.117:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.1.118:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.1.119:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.2.120:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.2.121:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.2.122:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.2.123:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.2.124:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.2.125:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.2.126:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.2.127:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.2.128:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.2.129:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.2.130:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.2.131:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.2.132:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.2.133:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.2.134:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.2.135:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.2.136:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.2.137:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.2.138:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.2.139:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.2.140:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.2.141:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.2.142:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.2.143:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.2.144:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.2.145:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.2.147:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.3.146:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.3.146:beta:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.3.148:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.3.148:beta:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.3.149:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.3.149:beta:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.3.150:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.3.150:beta:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.3.151:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.3.151:beta:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.3.152:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.3.152:beta:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.3.153:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.3.154:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.3.155:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.3.156:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.3.157:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.3.158:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.3.159:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.3.160:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.3.161:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.3.162:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.3.163:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.3.164:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.3.165:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.3.166:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.3.167:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.3.168:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.3.169:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.3.170:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.3.171:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.3.172:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.3.173:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.3.174:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.3.175:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.4.177:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.4.178:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.4.181:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.4.182:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.4.183:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.4.184:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.4.185:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.4.186:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.4.187:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.4.188:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.4.190:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.4.191:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.4.192:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.4.193:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.4.194:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.4.195:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.4.196:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.4.197:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.4.198:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.4.199:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:1.4.200:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:2.0.202:*:*:*:*:*:*:*",
		"cpe:2.3:a:h2database:h2:2.0.204:*:*:*:*:*:*:*"
	]
}
