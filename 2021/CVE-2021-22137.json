{
	"id": "CVE-2021-22137",
	"sourceIdentifier": "bressers@elastic.co",
	"vulnStatus": "Modified",
	"published": "2021-05-13T18:15:09.033",
	"lastModified": "2024-11-21T05:49:34.683",
	"descriptions": [
		{
			"lang": "en",
			"value": "In Elasticsearch versions before 7.11.2 and 6.8.15 a document disclosure flaw was found when Document or Field Level Security is used. Search queries do not properly preserve security permissions when executing certain cross-cluster search queries. This could result in the search disclosing the existence of documents the attacker should not be able to view. This could result in an attacker gaining additional insight into potentially sensitive indices."
		},
		{
			"lang": "es",
			"value": "En Elasticsearch versiones anteriores a 7.11.2 y la 6.8.15, se encontró un fallo en la divulgación del documento cuando Document o Field Level Security es usado.&#xa0;Las consultas de Búsqueda no conservan apropiadamente los permisos de seguridad al ejecutar determinadas consultas de búsqueda cross-cluster.&#xa0;Esto podría resultar en que la búsqueda revele la existencia de documentos que el atacante no sería capaz de visualizar.&#xa0;Esto podría resultar en que un atacante obtenga información adicional sobre índices potencialmente confiables"
		}
	],
	"references": [
		{
			"source": "bressers@elastic.co",
			"tags": [
				"Vendor Advisory"
			],
			"url": "https://discuss.elastic.co/t/elastic-stack-7-12-0-and-6-8-15-security-update/268125"
		},
		{
			"source": "bressers@elastic.co",
			"tags": [
				"Third Party Advisory"
			],
			"url": "https://security.netapp.com/advisory/ntap-20210625-0003/"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Vendor Advisory"
			],
			"url": "https://discuss.elastic.co/t/elastic-stack-7-12-0-and-6-8-15-security-update/268125"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Third Party Advisory"
			],
			"url": "https://security.netapp.com/advisory/ntap-20210625-0003/"
		}
	],
	"metrics": {
		"cvssMetricV2": [
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "2.0",
					"vectorString": "AV:N/AC:M/Au:N/C:P/I:N/A:N",
					"accessVector": "NETWORK",
					"accessComplexity": "MEDIUM",
					"authentication": "NONE",
					"confidentialityImpact": "PARTIAL",
					"integrityImpact": "NONE",
					"availabilityImpact": "NONE",
					"baseScore": 4.3
				},
				"baseSeverity": "MEDIUM",
				"exploitabilityScore": 8.6,
				"impactScore": 2.9
			}
		],
		"cvssMetricV31": [
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
					"attackVector": "NETWORK",
					"attackComplexity": "LOW",
					"privilegesRequired": "NONE",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "LOW",
					"integrityImpact": "NONE",
					"availabilityImpact": "NONE",
					"baseScore": 5.3,
					"baseSeverity": "MEDIUM"
				},
				"exploitabilityScore": 3.9,
				"impactScore": 1.4
			}
		]
	},
	"weaknesses": [
		{
			"source": "bressers@elastic.co",
			"type": "Secondary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-200"
				}
			]
		},
		{
			"source": "nvd@nist.gov",
			"type": "Primary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-281"
				}
			]
		}
	],
	"configurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:elastic:elasticsearch:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "5F9FE5BF-96E1-47AF-A8DF-3836949E3BE6",
							"versionEndExcluding": "6.8.15"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:elastic:elasticsearch:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "676FCEC5-9858-437A-A06F-9A6C08502E7E",
							"versionStartIncluding": "7.11.0",
							"versionEndExcluding": "7.11.2"
						}
					]
				}
			]
		}
	],
	"vcConfigurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:elasticsearch:elasticsearch:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "",
							"versionEndIncluding": "6.8.14"
						},
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:elasticsearch:elasticsearch:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "",
							"versionStartIncluding": "7.11.0",
							"versionEndIncluding": "7.11.1"
						}
					]
				}
			]
		}
	],
	"vcVulnerableCPEs": [
		"cpe:2.3:a:elasticsearch:elasticsearch:1.1.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:elasticsearch:elasticsearch:1.2.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:elasticsearch:elasticsearch:1.3.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:elasticsearch:elasticsearch:1.4.0.Beta1:*:*:*:*:*:*:*",
		"cpe:2.3:a:elasticsearch:elasticsearch:1.4.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:elasticsearch:elasticsearch:1.4.0:beta1:*:*:*:*:*:*",
		"cpe:2.3:a:elasticsearch:elasticsearch:1.4.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:elasticsearch:elasticsearch:1.4.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:elasticsearch:elasticsearch:1.4.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:elasticsearch:elasticsearch:1.5.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:elasticsearch:elasticsearch:1.5.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:elasticsearch:elasticsearch:1.6.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:elasticsearch:elasticsearch:5.6.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:elasticsearch:elasticsearch:5.6.12:*:*:*:*:*:*:*",
		"cpe:2.3:a:elasticsearch:elasticsearch:5.6.15:*:*:*:*:*:*:*",
		"cpe:2.3:a:elasticsearch:elasticsearch:5.6.9:*:*:*:*:*:*:*",
		"cpe:2.3:a:elasticsearch:elasticsearch:6.0.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:elasticsearch:elasticsearch:6.2.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:elasticsearch:elasticsearch:6.4.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:elasticsearch:elasticsearch:6.4.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:elasticsearch:elasticsearch:6.4.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:elasticsearch:elasticsearch:6.5.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:elasticsearch:elasticsearch:6.5.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:elasticsearch:elasticsearch:6.6.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:elasticsearch:elasticsearch:6.7.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:elasticsearch:elasticsearch:6.8.12:*:*:*:*:*:*:*",
		"cpe:2.3:a:elasticsearch:elasticsearch:6.8.13:*:*:*:*:*:*:*",
		"cpe:2.3:a:elasticsearch:elasticsearch:6.8.14:*:*:*:*:*:*:*",
		"cpe:2.3:a:elasticsearch:elasticsearch:6.8.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:elasticsearch:elasticsearch:6.8.3:*:*:*:*:*:*:*",
		"cpe:2.3:a:elasticsearch:elasticsearch:6.8.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:elasticsearch:elasticsearch:6.8.8:*:*:*:*:*:*:*",
		"cpe:2.3:a:elasticsearch:elasticsearch:7.11.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:elasticsearch:elasticsearch:7.11.1:*:*:*:*:*:*:*"
	]
}
