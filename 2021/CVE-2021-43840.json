{
	"id": "CVE-2021-43840",
	"sourceIdentifier": "security-advisories@github.com",
	"vulnStatus": "Modified",
	"published": "2021-12-17T19:15:07.757",
	"lastModified": "2024-11-21T06:29:54.360",
	"descriptions": [
		{
			"lang": "en",
			"value": "message_bus is a messaging bus for Ruby processes and web clients. In versions prior to 3.3.7 users who deployed message bus with diagnostics features enabled (default off) are vulnerable to a path traversal bug, which could lead to disclosure of secret information on a machine if an unintended user were to gain access to the diagnostic route. The impact is also greater if there is no proxy for your web application as the number of steps up the directories is not bounded. For deployments which uses a proxy, the impact varies. For example, If a request goes through a proxy like Nginx with `merge_slashes` enabled, the number of steps up the directories that can be read is limited to 3 levels. This issue has been patched in version 3.3.7. Users unable to upgrade should ensure that MessageBus::Diagnostics is disabled."
		},
		{
			"lang": "es",
			"value": "message_bus es un bus de mensajería para procesos Ruby y clientes web. En las versiones anteriores a 3.3.7, los usuarios que desplegaron el bus de mensajes con las características de diagnóstico habilitadas (por defecto deshabilitadas) son vulnerables a un bug de salto de ruta, que podría conllevar a una revelación de información secreta en una máquina si un usuario no intencionado accediera a la ruta de diagnóstico. El impacto también es mayor si no se presenta un proxy para su aplicación web, ya que el número de pasos por los directorios no está limitado. Para las implementaciones que usan un proxy, el impacto varía. Por ejemplo, si una petición pasa por un proxy como Nginx con \"merge_slashes\" habilitado, el número de pasos hacia arriba en los directorios que pueden ser leídos está limitado a 3 niveles. Este problema ha sido parcheado en la versión 3.3.7. Los usuarios que no puedan actualizarse deberán asegurarse de que MessageBus::Diagnostics está deshabilitado"
		}
	],
	"references": [
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Patch",
				"Third Party Advisory"
			],
			"url": "https://github.com/discourse/message_bus/commit/9b6deee01ed474c7e9b5ff65a06bb0447b4db2ba"
		},
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Third Party Advisory"
			],
			"url": "https://github.com/discourse/message_bus/security/advisories/GHSA-xmgj-5fh3-xjmm"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Patch",
				"Third Party Advisory"
			],
			"url": "https://github.com/discourse/message_bus/commit/9b6deee01ed474c7e9b5ff65a06bb0447b4db2ba"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Third Party Advisory"
			],
			"url": "https://github.com/discourse/message_bus/security/advisories/GHSA-xmgj-5fh3-xjmm"
		}
	],
	"metrics": {
		"cvssMetricV2": [
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "2.0",
					"vectorString": "AV:N/AC:M/Au:S/C:P/I:N/A:N",
					"accessVector": "NETWORK",
					"accessComplexity": "MEDIUM",
					"authentication": "SINGLE",
					"confidentialityImpact": "PARTIAL",
					"integrityImpact": "NONE",
					"availabilityImpact": "NONE",
					"baseScore": 3.5
				},
				"baseSeverity": "LOW",
				"exploitabilityScore": 6.8,
				"impactScore": 2.9
			}
		],
		"cvssMetricV31": [
			{
				"source": "security-advisories@github.com",
				"type": "Secondary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:N/A:N",
					"attackVector": "NETWORK",
					"attackComplexity": "HIGH",
					"privilegesRequired": "HIGH",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "HIGH",
					"integrityImpact": "NONE",
					"availabilityImpact": "NONE",
					"baseScore": 4.4,
					"baseSeverity": "MEDIUM"
				},
				"exploitabilityScore": 0.7,
				"impactScore": 3.6
			},
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
					"attackVector": "NETWORK",
					"attackComplexity": "LOW",
					"privilegesRequired": "LOW",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "HIGH",
					"integrityImpact": "NONE",
					"availabilityImpact": "NONE",
					"baseScore": 6.5,
					"baseSeverity": "MEDIUM"
				},
				"exploitabilityScore": 2.8,
				"impactScore": 3.6
			}
		]
	},
	"weaknesses": [
		{
			"source": "security-advisories@github.com",
			"type": "Primary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-22"
				}
			]
		}
	],
	"configurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:discourse:message_bus:*:*:*:*:*:ruby:*:*",
							"matchCriteriaId": "1BFAB388-520F-4B06-8DC0-2F6821BA0898",
							"versionEndExcluding": "3.3.7"
						}
					]
				}
			]
		}
	],
	"vcConfigurations": [
		{
			"nodes": [
				{
					"operator": "",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:discourse:message_bus:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "",
							"versionEndExcluding": "3.3.7"
						}
					]
				}
			]
		}
	],
	"vcVulnerableCPEs": [
		"cpe:2.3:a:discourse:message_bus:0.0.1:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:0.0.2:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:0.9.3.1:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:0.9.3.2:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:0.9.3:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:0.9.5:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:0.9.6:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:1.0.0:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:1.0.10:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:1.0.11:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:1.0.12:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:1.0.13:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:1.0.14:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:1.0.15:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:1.0.16:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:1.0.1:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:1.0.3:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:1.0.4:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:1.0.5:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:1.0.6:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:1.0.7:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:1.0.8:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:1.0.9:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:1.1.0:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:1.1.1:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:2.0.0:-:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:2.0.0:beta10:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:2.0.0:beta11:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:2.0.0:beta1:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:2.0.0:beta2:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:2.0.0:beta3:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:2.0.0:beta4:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:2.0.0:beta5:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:2.0.0:beta6:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:2.0.0:beta7:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:2.0.0:beta8:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:2.0.0:beta9:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:2.0.1:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:2.0.2:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:2.0.3:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:2.0.5:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:2.0.6:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:2.0.7:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:2.0.8:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:2.0.9:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:2.1.0:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:2.1.1:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:2.1.2:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:2.1.3:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:2.1.4:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:2.1.5:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:2.1.6:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:2.2.0:-:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:2.2.0:pre1:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:2.2.0:pre2:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:2.2.0:pre:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:2.2.1:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:2.2.2:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:2.2.3:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:2.2.4:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:3.0.0:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:3.1.0:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:3.2.0:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:3.3.1:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:3.3.2:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:3.3.3:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:3.3.4:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:3.3.5:*:*:*:*:ruby:*:*",
		"cpe:2.3:a:discourse:message_bus:3.3.6:*:*:*:*:ruby:*:*"
	]
}
