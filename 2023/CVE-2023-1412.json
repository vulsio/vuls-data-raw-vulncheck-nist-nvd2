{
	"id": "CVE-2023-1412",
	"sourceIdentifier": "cna@cloudflare.com",
	"vulnStatus": "Modified",
	"published": "2023-04-05T16:15:07.220",
	"lastModified": "2024-11-21T07:39:08.370",
	"descriptions": [
		{
			"lang": "en",
			"value": "An unprivileged (non-admin) user can exploit an Improper Access Control vulnerability in the Cloudflare WARP Client for Windows (<= 2022.12.582.0) to perform privileged operations with SYSTEM context by working with a combination of opportunistic locks (oplock) and symbolic links (which can both be created by an unprivileged user).\n\nAfter installing the Cloudflare WARP Client (admin privileges required), an MSI-Installer is placed under C:\\Windows\\Installer. The vulnerability lies in the repair function of this MSI.\n\nImpactAn unprivileged (non-admin) user can exploit this vulnerability to perform privileged operations with SYSTEM context, including deleting arbitrary files and reading arbitrary file content. This can lead to a variety of attacks, including the manipulation of system files and privilege escalation.\n\nPatchesA new installer with a fix that addresses this vulnerability was released in version 2023.3.381.0. While the WARP Client itself is not vulnerable (only the installer), users are encouraged to upgrade to the latest version and delete any older installers present in their systems.\n\n\n\n\n"
		}
	],
	"references": [
		{
			"source": "cna@cloudflare.com",
			"tags": [
				"Product"
			],
			"url": "https://developers.cloudflare.com/warp-client/get-started/windows/"
		},
		{
			"source": "cna@cloudflare.com",
			"tags": [
				"Vendor Advisory"
			],
			"url": "https://github.com/cloudflare/advisories/security/advisories/GHSA-hgxh-48m3-3gq7"
		},
		{
			"source": "cna@cloudflare.com",
			"tags": [
				"Release Notes"
			],
			"url": "https://install.appcenter.ms/orgs/cloudflare/apps/1.1.1.1-windows-1/distribution_groups/release"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Product"
			],
			"url": "https://developers.cloudflare.com/warp-client/get-started/windows/"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Vendor Advisory"
			],
			"url": "https://github.com/cloudflare/advisories/security/advisories/GHSA-hgxh-48m3-3gq7"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Release Notes"
			],
			"url": "https://install.appcenter.ms/orgs/cloudflare/apps/1.1.1.1-windows-1/distribution_groups/release"
		}
	],
	"metrics": {
		"cvssMetricV31": [
			{
				"source": "cna@cloudflare.com",
				"type": "Secondary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
					"attackVector": "LOCAL",
					"attackComplexity": "HIGH",
					"privilegesRequired": "LOW",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "HIGH",
					"integrityImpact": "HIGH",
					"availabilityImpact": "HIGH",
					"baseScore": 7,
					"baseSeverity": "HIGH"
				},
				"exploitabilityScore": 1,
				"impactScore": 5.9
			},
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
					"attackVector": "LOCAL",
					"attackComplexity": "LOW",
					"privilegesRequired": "LOW",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "HIGH",
					"integrityImpact": "HIGH",
					"availabilityImpact": "HIGH",
					"baseScore": 7.8,
					"baseSeverity": "HIGH"
				},
				"exploitabilityScore": 1.8,
				"impactScore": 5.9
			}
		]
	},
	"weaknesses": [
		{
			"source": "cna@cloudflare.com",
			"type": "Secondary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-59"
				}
			]
		},
		{
			"source": "nvd@nist.gov",
			"type": "Primary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-59"
				}
			]
		}
	],
	"configurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:cloudflare:warp:*:*:*:*:*:windows:*:*",
							"matchCriteriaId": "B8FB60C0-986F-4205-9EE1-05C745FEF2AB",
							"versionEndExcluding": "2023.3.381.0"
						}
					]
				}
			]
		}
	],
	"vcConfigurations": [
		{
			"nodes": [
				{
					"operator": "",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:cloudflare:warp:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "",
							"versionEndIncluding": "2022.5.309.0"
						}
					]
				}
			]
		}
	],
	"vcVulnerableCPEs": [
		"cpe:2.3:a:cloudflare:warp:1.2.1386:*:*:*:*:macos:*:*",
		"cpe:2.3:a:cloudflare:warp:1.2.1387:*:*:*:*:macos:*:*",
		"cpe:2.3:a:cloudflare:warp:1.2.1441:*:*:*:*:macos:*:*",
		"cpe:2.3:a:cloudflare:warp:1.2.1442:*:*:*:*:macos:*:*",
		"cpe:2.3:a:cloudflare:warp:1.2.1444:*:*:*:*:macos:*:*",
		"cpe:2.3:a:cloudflare:warp:1.2.1445:*:*:*:*:macos:*:*",
		"cpe:2.3:a:cloudflare:warp:1.2.1467:*:*:*:*:macos:*:*",
		"cpe:2.3:a:cloudflare:warp:1.2.1522:*:*:*:*:macos:*:*",
		"cpe:2.3:a:cloudflare:warp:1.2.1523:*:*:*:*:macos:*:*",
		"cpe:2.3:a:cloudflare:warp:1.2.1563:*:*:*:*:macos:*:*",
		"cpe:2.3:a:cloudflare:warp:1.2.1564:*:*:*:*:macos:*:*",
		"cpe:2.3:a:cloudflare:warp:1.2.1590:*:*:*:*:macos:*:*",
		"cpe:2.3:a:cloudflare:warp:1.2.1591:*:*:*:*:macos:*:*",
		"cpe:2.3:a:cloudflare:warp:1.2.1866:*:*:*:*:macos:*:*",
		"cpe:2.3:a:cloudflare:warp:1.2.1924:*:*:*:*:macos:*:*",
		"cpe:2.3:a:cloudflare:warp:1.2.1989:*:*:*:*:macos:*:*",
		"cpe:2.3:a:cloudflare:warp:1.2.2240:*:*:*:*:macos:*:*",
		"cpe:2.3:a:cloudflare:warp:1.2.2278:*:*:*:*:macos:*:*",
		"cpe:2.3:a:cloudflare:warp:1.2.2544.0:*:*:*:*:windows:*:*",
		"cpe:2.3:a:cloudflare:warp:1.2.2695.1:*:*:*:*:windows:*:*",
		"cpe:2.3:a:cloudflare:warp:1.2.2834.0:*:*:*:*:windows:*:*",
		"cpe:2.3:a:cloudflare:warp:1.2.2866.0:*:*:*:*:windows:*:*",
		"cpe:2.3:a:cloudflare:warp:1.3.184.0:*:*:*:*:windows:*:*",
		"cpe:2.3:a:cloudflare:warp:1.3.206:*:*:*:*:macos:*:*",
		"cpe:2.3:a:cloudflare:warp:1.3.58:*:*:*:*:macos:*:*",
		"cpe:2.3:a:cloudflare:warp:1.4.106:*:*:*:*:macos:*:*",
		"cpe:2.3:a:cloudflare:warp:1.4.107.0:*:*:*:*:windows:*:*",
		"cpe:2.3:a:cloudflare:warp:1.4.25.0:*:*:*:*:windows:*:*",
		"cpe:2.3:a:cloudflare:warp:1.4.27:*:*:*:*:macos:*:*",
		"cpe:2.3:a:cloudflare:warp:1.4.33.0:*:*:*:*:windows:*:*",
		"cpe:2.3:a:cloudflare:warp:1.4.34:*:*:*:*:macos:*:*",
		"cpe:2.3:a:cloudflare:warp:1.5.147.0:*:*:*:*:windows:*:*",
		"cpe:2.3:a:cloudflare:warp:1.5.148.0:*:*:*:*:macos:*:*",
		"cpe:2.3:a:cloudflare:warp:1.5.206.0:*:*:*:*:windows:*:*",
		"cpe:2.3:a:cloudflare:warp:1.5.207.0:*:*:*:*:macos:*:*",
		"cpe:2.3:a:cloudflare:warp:1.5.294.0:*:*:*:*:macos:*:*",
		"cpe:2.3:a:cloudflare:warp:1.5.295.0:*:*:*:*:windows:*:*",
		"cpe:2.3:a:cloudflare:warp:1.5.461.0:*:*:*:*:windows:*:*",
		"cpe:2.3:a:cloudflare:warp:1.5.463.0:*:*:*:*:macos:*:*",
		"cpe:2.3:a:cloudflare:warp:1.6.27.0:*:*:*:*:macos:*:*",
		"cpe:2.3:a:cloudflare:warp:1.6.28.0:*:*:*:*:windows:*:*",
		"cpe:2.3:a:cloudflare:warp:2021.11.155.0:*:*:*:*:windows:*:*",
		"cpe:2.3:a:cloudflare:warp:2021.11.276.0:*:*:*:*:windows:*:*",
		"cpe:2.3:a:cloudflare:warp:2021.11.281.0:*:*:*:*:macos:*:*",
		"cpe:2.3:a:cloudflare:warp:2021.12.1.0:*:*:*:*:macos:*:*",
		"cpe:2.3:a:cloudflare:warp:2021.12.2.0:*:*:*:*:windows:*:*",
		"cpe:2.3:a:cloudflare:warp:2022.2.247.0:*:*:*:*:windows:*:*",
		"cpe:2.3:a:cloudflare:warp:2022.2.248.0:*:*:*:*:macos:*:*",
		"cpe:2.3:a:cloudflare:warp:2022.2.69.0:*:*:*:*:macos:*:*",
		"cpe:2.3:a:cloudflare:warp:2022.2.95.0:*:*:*:*:windows:*:*",
		"cpe:2.3:a:cloudflare:warp:2022.3.186.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:cloudflare:warp:2022.3.186.0:*:*:*:*:windows:*:*",
		"cpe:2.3:a:cloudflare:warp:2022.3.187.0:*:*:*:*:macos:*:*",
		"cpe:2.3:a:cloudflare:warp:2022.3.36.0:*:*:*:*:macos:*:*",
		"cpe:2.3:a:cloudflare:warp:2022.3.63.0:*:*:*:*:windows:*:*",
		"cpe:2.3:a:cloudflare:warp:2022.4.114.0:*:*:*:*:macos:*:*",
		"cpe:2.3:a:cloudflare:warp:2022.4.115.0:*:*:*:*:windows:*:*",
		"cpe:2.3:a:cloudflare:warp:2022.5.0.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:cloudflare:warp:2022.5.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:cloudflare:warp:2022.5.226.0:*:*:*:*:windows:*:*",
		"cpe:2.3:a:cloudflare:warp:2022.5.227.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:cloudflare:warp:2022.5.227.0:*:*:*:*:macos:*:*",
		"cpe:2.3:a:cloudflare:warp:2022.5.309.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:cloudflare:warp:2022.5.309.0:*:*:*:*:windows:*:*",
		"cpe:2.3:a:cloudflare:warp:6.14:*:*:*:*:*:*:*",
		"cpe:2.3:a:cloudflare:warp:6.15:*:*:*:*:*:*:*",
		"cpe:2.3:a:cloudflare:warp:6.20:*:*:*:*:*:*:*",
		"cpe:2.3:a:cloudflare:warp:6.29:*:*:*:*:*:*:*",
		"cpe:2.3:a:cloudflare:warp:6.29:*:*:*:*:android:*:*"
	]
}
