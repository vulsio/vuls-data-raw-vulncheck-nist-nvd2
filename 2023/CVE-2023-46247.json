{
	"id": "CVE-2023-46247",
	"sourceIdentifier": "security-advisories@github.com",
	"vulnStatus": "Modified",
	"published": "2023-12-13T20:15:49.360",
	"lastModified": "2024-11-21T08:28:09.720",
	"descriptions": [
		{
			"lang": "en",
			"value": "Vyper is a Pythonic Smart Contract Language for the Ethereum Virtual Machine (EVM). Contracts containing large arrays might underallocate the number of slots they need by 1. Prior to v0.3.8, the calculation to determine how many slots a storage variable needed used `math.ceil(type_.size_in_bytes / 32)`. The intermediate floating point step can produce a rounding error if there are enough bits set in the IEEE-754 mantissa. Roughly speaking, if `type_.size_in_bytes` is large (> 2**46), and slightly less than a power of 2, the calculation can overestimate how many slots are needed by 1. If `type_.size_in_bytes` is slightly more than a power of 2, the calculation can underestimate how many slots are needed by 1. This issue is patched in version 0.3.8."
		},
		{
			"lang": "es",
			"value": "Vyper es un lenguaje de contrato inteligente pitónico para la máquina virtual Ethereum (EVM). Los contratos que contienen matrices grandes podrían subasignar la cantidad de ranuras que necesitan en 1. Antes de v0.3.8, el cálculo para determinar cuántas ranuras necesitaba una variable de almacenamiento usaba `math.ceil(type_.size_in_bytes / 32)`. El paso de punto flotante intermedio puede producir un error de redondeo si hay suficientes bits configurados en la mantisa IEEE-754. En términos generales, si `type_.size_in_bytes` es grande (&gt; 2**46) y ligeramente menor que una potencia de 2, el cálculo puede sobrestimar cuántas ranuras se necesitan por 1. Si `type_.size_in_bytes` es ligeramente mayor que una potencia de 2, el cálculo puede subestimar cuántas ranuras se necesitan por 1. Este problema se solucionó en la versión 0.3.8."
		}
	],
	"references": [
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Product"
			],
			"url": "https://github.com/vyperlang/vyper/blob/6020b8bbf66b062d299d87bc7e4eddc4c9d1c157/vyper/semantics/validation/data_positions.py#L197"
		},
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Patch"
			],
			"url": "https://github.com/vyperlang/vyper/commit/0bb7203b584e771b23536ba065a6efda457161bb"
		},
		{
			"source": "security-advisories@github.com",
			"tags": [
				"Third Party Advisory"
			],
			"url": "https://github.com/vyperlang/vyper/security/advisories/GHSA-6m97-7527-mh74"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Product"
			],
			"url": "https://github.com/vyperlang/vyper/blob/6020b8bbf66b062d299d87bc7e4eddc4c9d1c157/vyper/semantics/validation/data_positions.py#L197"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Patch"
			],
			"url": "https://github.com/vyperlang/vyper/commit/0bb7203b584e771b23536ba065a6efda457161bb"
		},
		{
			"source": "af854a3a-2127-422b-91ae-364da2661108",
			"tags": [
				"Third Party Advisory"
			],
			"url": "https://github.com/vyperlang/vyper/security/advisories/GHSA-6m97-7527-mh74"
		}
	],
	"metrics": {
		"cvssMetricV31": [
			{
				"source": "security-advisories@github.com",
				"type": "Secondary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N",
					"attackVector": "NETWORK",
					"attackComplexity": "LOW",
					"privilegesRequired": "NONE",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "NONE",
					"integrityImpact": "HIGH",
					"availabilityImpact": "NONE",
					"baseScore": 7.5,
					"baseSeverity": "HIGH"
				},
				"exploitabilityScore": 3.9,
				"impactScore": 3.6
			},
			{
				"source": "nvd@nist.gov",
				"type": "Primary",
				"cvssData": {
					"version": "3.1",
					"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N",
					"attackVector": "NETWORK",
					"attackComplexity": "LOW",
					"privilegesRequired": "NONE",
					"userInteraction": "NONE",
					"scope": "UNCHANGED",
					"confidentialityImpact": "NONE",
					"integrityImpact": "HIGH",
					"availabilityImpact": "NONE",
					"baseScore": 7.5,
					"baseSeverity": "HIGH"
				},
				"exploitabilityScore": 3.9,
				"impactScore": 3.6
			}
		]
	},
	"weaknesses": [
		{
			"source": "security-advisories@github.com",
			"type": "Primary",
			"description": [
				{
					"lang": "en",
					"value": "CWE-193"
				},
				{
					"lang": "en",
					"value": "CWE-682"
				}
			]
		}
	],
	"configurations": [
		{
			"nodes": [
				{
					"operator": "OR",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:vyperlang:vyper:*:*:*:*:*:python:*:*",
							"matchCriteriaId": "CE735083-742D-4FFC-922C-71E242E471F3",
							"versionEndExcluding": "0.3.8"
						}
					]
				}
			]
		}
	],
	"vcConfigurations": [
		{
			"nodes": [
				{
					"operator": "",
					"cpeMatch": [
						{
							"vulnerable": true,
							"criteria": "cpe:2.3:a:vyperlang:vyper:*:*:*:*:*:*:*:*",
							"matchCriteriaId": "",
							"versionEndIncluding": "0.3.7"
						}
					]
				}
			]
		}
	],
	"vcVulnerableCPEs": [
		"cpe:2.3:a:vyperlang:vyper:0.0.4:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.1.0:beta10:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.1.0:beta11:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.1.0:beta12:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.1.0:beta13:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.1.0:beta14:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.1.0:beta15:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.1.0:beta16:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.1.0:beta17:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.1.0:beta1:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.1.0:beta2:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.1.0:beta3:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.1.0:beta4:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.1.0:beta5:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.1.0:beta6:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.1.0:beta7:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.1.0:beta8:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.1.0:beta9:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.0:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.10:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.11:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.12:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.13:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.14:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.15:*:*:*:*:*:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.15:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.16:*:*:*:*:*:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.16:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.1:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.2:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.3:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.4:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.5:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.6:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.7:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.8:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.9:*:*:*:*:*:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.2.9:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.3.0:*:*:*:*:*:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.3.0:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.3.1:*:*:*:*:*:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.3.1:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.3.2:*:*:*:*:*:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.3.2:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.3.3:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.3.4:*:*:*:*:*:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.3.4:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.3.5:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.3.6:*:*:*:*:python:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.3.7:*:*:*:*:*:*:*",
		"cpe:2.3:a:vyperlang:vyper:0.3.7:*:*:*:*:python:*:*"
	]
}
